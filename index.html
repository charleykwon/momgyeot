<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#FDF8F3">
    <title>ÎßòÍ≥Å - ÏóÑÎßàÏôÄ ÏïÑÍ∏∞Î•º ÏúÑÌïú AI ÎèôÎ∞òÏûê</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        /* iOS Safe Area ÏßÄÏõê */
        html {
            height: 100%;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #FDF8F3;
            min-height: 100%;
            min-height: 100dvh; /* Dynamic viewport height for mobile */
            overflow: hidden;
            /* PWA Ï†ÑÏ≤¥ÌôîÎ©¥ ÏßÄÏõê */
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        /* ÌíÄÏä§ÌÅ¨Î¶∞ - ÏïÑÏù¥Ìè∞ ÌîÑÎ†àÏûÑ Ï†úÍ±∞ */
        .iphone-frame {
            display: contents;
        }
        
        .notch {
            display: none;
        }
        
        .screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            height: 100%;
            height: 100dvh;
            background: #FDF8F3;
            overflow: hidden;
            /* iOS Safe Area */
            padding-top: env(safe-area-inset-top);
            padding-bottom: env(safe-area-inset-bottom);
            padding-left: env(safe-area-inset-left);
            padding-right: env(safe-area-inset-right);
        }
        
        .home-indicator {
            display: none;
        }
        
        /* ÌôîÎ©¥ Ï†ÑÌôò */
        .page {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            transition: opacity 0.3s, transform 0.3s;
        }
        
        .page.hidden {
            opacity: 0;
            pointer-events: none;
            transform: translateX(20px);
        }
        
        /* ==================== Ïù∏Ìä∏Î°ú ÌôîÎ©¥ ==================== */
        .intro-screen {
            background: #000;
            position: relative;
        }
        
        .intro-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
        }
        
        .intro-bg img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            object-position: center center;
            transform: scale(1.3);
            animation: slowZoom 25s ease-in-out infinite alternate;
        }
        
        @keyframes slowZoom {
            0% { transform: scale(1.3) translateY(0); }
            100% { transform: scale(1.4) translateY(-3%); }
        }
        
        .intro-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(180deg,
                rgba(0, 0, 0, 0.1) 0%,
                rgba(0, 0, 0, 0.2) 30%,
                rgba(0, 0, 0, 0.5) 70%,
                rgba(0, 0, 0, 0.7) 100%
            );
        }
        
        .intro-content {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            
            flex-direction: column;
            
            
            padding: 24px;
            padding-bottom: 45px;
            z-index: 10;
            text-align: center;
        }
        
        .intro-logo {
            margin-bottom: 24px;
            opacity: 0;
            animation: fadeInDown 1s ease 0.3s forwards;
        }
        
        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .intro-logo-icon {
            width: 56px;
            height: 56px;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            
            
            
            font-size: 28px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
            margin: 0 auto 12px;
        }
        
        .intro-brand {
            font-size: 12px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            letter-spacing: 2px;
        }
        
        .intro-headline h1 {
            font-size: 26px;
            font-weight: 700;
            color: #FFFFFF;
            line-height: 1.6;
            margin-bottom: 16px;
            text-shadow: 0 2px 20px rgba(0, 0, 0, 0.3);
        }
        
        .intro-headline h1 span.highlight {
            color: #E8B4B8;
        }
        
        /* ÌÉÄÏù¥Ìïë Ìö®Í≥º */
        .typing-line {
            display: block;
            overflow: hidden;
            white-space: nowrap;
            width: 0;
            opacity: 0;
        }
        
        .typing-line.line1 {
            animation: typing 1.2s steps(12) 1s forwards, blink 0.5s step-end 1s 2;
        }
        
        .typing-line.line2 {
            animation: typing 1.2s steps(12) 2.4s forwards, blink 0.5s step-end 2.4s 2;
        }
        
        .typing-line.line3 {
            animation: typing 1.5s steps(15) 3.8s forwards;
        }
        
        @keyframes typing {
            from {
                width: 0;
                opacity: 1;
            }
            to {
                width: 100%;
                opacity: 1;
            }
        }
        
        @keyframes blink {
            50% { border-color: transparent; }
        }
        
        /* ÏÑúÎ∏å Ïπ¥Ìîº - ÎßàÏùå Ìö®Í≥º */
        .intro-subtitle {
            font-size: 14px;
            color: rgba(255, 255, 255, 0.85);
            line-height: 1.8;
            margin-bottom: 32px;
            text-shadow: 0 1px 10px rgba(0, 0, 0, 0.3);
            opacity: 0;
            animation: heartFadeIn 2s ease 5.5s forwards;
        }
        
        .intro-subtitle .heart-text {
            display: inline-block;
            animation: heartBeat 1.5s ease-in-out 6.5s infinite;
        }
        
        @keyframes heartFadeIn {
            0% {
                opacity: 0;
                transform: translateY(20px) scale(0.9);
            }
            50% {
                opacity: 0.5;
                transform: translateY(10px) scale(0.95);
            }
            100% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
        }
        
        @keyframes heartBeat {
            0%, 100% {
                transform: scale(1);
            }
            15% {
                transform: scale(1.05);
            }
            30% {
                transform: scale(1);
            }
            45% {
                transform: scale(1.03);
            }
        }
        
        .intro-cta {
            margin-bottom: 24px;
            opacity: 0;
            animation: fadeInUp 1s ease 7s forwards;
        }
        
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .intro-btn {
            display: inline-flex;
            
            gap: 10px;
            padding: 18px 40px;
            background: #E8B4B8;
            color: #3D4A2D;
            border: none;
            border-radius: 32px;
            font-size: 17px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 8px 32px rgba(232, 180, 184, 0.4);
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .intro-btn:hover {
            background: #F0C4C8;
            transform: translateY(-2px);
            box-shadow: 0 12px 40px rgba(232, 180, 184, 0.5);
        }
        
        .intro-footer {
            position: absolute;
            bottom: 30px;
            left: 0;
            right: 0;
            font-size: 11px;
            color: rgba(255, 255, 255, 0.5);
            text-align: center;
            opacity: 0;
            animation: fadeIn 1s ease 7.5s forwards;
        }
        
        @keyframes fadeIn {
            to { opacity: 1; }
        }
        
        /* ==================== Î°úÍ∑∏Ïù∏ ÌôîÎ©¥ ==================== */
        .login-screen {
            background: #FDF8F5;
            
            flex-direction: column;
        }
        
        .login-header {
            padding: 60px 28px 0;
            flex: 1;
        }
        
        .back-btn {
            width: 40px;
            height: 40px;
            background: rgba(94, 107, 58, 0.1);
            border: none;
            border-radius: 50%;
            
            
            
            cursor: pointer;
            margin-bottom: 40px;
            font-size: 18px;
            color: #5E6B3A;
        }
        
        .login-logo {
            margin-bottom: 32px;
        }
        
        .login-logo-icon {
            width: 64px;
            height: 64px;
            background: #fff;
            border-radius: 20px;
            
            
            
            font-size: 32px;
            box-shadow: 0 4px 20px rgba(94, 107, 58, 0.15);
            margin-bottom: 16px;
        }
        
        .login-title {
            font-size: 24px;
            font-weight: 700;
            color: #3D4A2D;
            line-height: 1.4;
            margin-bottom: 8px;
        }
        
        .login-desc {
            font-size: 14px;
            color: #8A8A8A;
        }
        
        .login-buttons {
            padding: 28px;
            padding-bottom: 48px;
        }
        
        .login-btn {
            width: 100%;
            padding: 16px;
            border-radius: 12px;
            font-size: 15px;
            font-weight: 600;
            cursor: pointer;
            
            
            
            gap: 12px;
            margin-bottom: 12px;
            border: none;
            font-family: inherit;
            transition: all 0.2s;
        }
        
        .login-btn:hover {
            transform: translateY(-1px);
        }
        
        .login-btn-kakao {
            background: #FEE500;
            color: #000;
        }
        
        .login-btn-google {
            background: #fff;
            color: #333;
            border: 1px solid #E0E0E0;
        }
        
        .login-btn-apple {
            background: #000;
            color: #fff;
        }
        
        .divider {
            
            
            gap: 16px;
            margin: 20px 0;
        }
        
        .divider-line {
            flex: 1;
            height: 1px;
            background: #E0E0E0;
        }
        
        .divider-text {
            font-size: 12px;
            color: #8A8A8A;
        }
        
        .login-btn-guest {
            background: rgba(94, 107, 58, 0.1);
            color: #5E6B3A;
        }
        
        /* Î≤ÑÌäº ÏïÑÏù¥ÏΩò */
        .btn-icon {
            width: 20px;
            height: 20px;
        }
        
        /* ==================== Ìôà ÌôîÎ©¥ ==================== */
        .home-screen {
            background: #FDF8F5;
            
            flex-direction: column;
        }
        
        .home-header {
            
            justify-content: space-between;
            
            padding: 60px 20px 20px;
        }
        
        .home-greeting {
            
            
            gap: 12px;
        }
        
        .greeting-emoji {
            font-size: 32px;
        }
        
        .greeting-text {
            font-size: 14px;
            color: #8A8A8A;
        }
        
        .greeting-name {
            font-size: 18px;
            font-weight: 700;
            color: #3D4A2D;
        }
        
        .home-icons {
            
            gap: 8px;
        }
        
        .icon-btn {
            width: 40px;
            height: 40px;
            background: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(0,0,0,0.06);
        }
        
        .home-content {
            flex: 1;
            padding: 0 20px;
            overflow-y: auto;
            padding-bottom: calc(100px + env(safe-area-inset-bottom, 0px));
        }
        
        .section-title {
            font-size: 22px;
            font-weight: 700;
            color: #3D4A2D;
            margin-bottom: 4px;
        }
        
        .section-desc {
            font-size: 14px;
            color: #8A8A8A;
            margin-bottom: 20px;
        }
        
        .mate-cards {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .mate-card {
            background: white;
            border-radius: 20px;
            padding: 20px 16px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
            position: relative;
        }
        
        .mate-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 8px 24px rgba(94, 107, 58, 0.15);
        }
        
        .mate-tag {
            position: absolute;
            top: 12px;
            left: 12px;
            font-size: 10px;
            font-weight: 600;
            color: #5E6B3A;
            background: rgba(94, 107, 58, 0.1);
            padding: 4px 8px;
            border-radius: 6px;
        }
        
        .mate-icon {
            font-size: 40px;
            margin-bottom: 12px;
            margin-top: 8px;
        }
        
        .mate-card h3 {
            font-size: 16px;
            font-weight: 700;
            color: #3D4A2D;
            margin-bottom: 6px;
        }
        
        .mate-card p {
            font-size: 12px;
            color: #8A8A8A;
            line-height: 1.4;
        }
        
        /* ÌïòÎã® ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò */
        .bottom-nav {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            height: calc(85px + env(safe-area-inset-bottom, 0px));
            background: white;
            
            justify-content: space-around;
            align-items: flex-start;
            padding-top: 12px;
            border-top: 1px solid #f0f0f0;
            padding-bottom: calc(25px + env(safe-area-inset-bottom, 0px));
        }
        
        .nav-item {
            
            flex-direction: column;
            
            gap: 4px;
            background: none;
            border: none;
            cursor: pointer;
            color: #BDBDBD;
            transition: color 0.2s;
        }
        
        .nav-item.active {
            color: #5E6B3A;
        }
        
        .nav-item span {
            font-size: 11px;
            font-weight: 500;
        }
        
        /* ==================== Ïò®Î≥¥Îî© ÌôîÎ©¥ ==================== */
        .onboarding-screen {
            background: #FDF8F3;
            
            flex-direction: column;
        }
        
        .onboarding-header {
            
            
            justify-content: space-between;
            padding: 16px 20px;
            background: #FDF8F3;
        }
        
        .onboarding-progress {
            font-size: 14px;
            font-weight: 600;
            color: #5E6B3A;
            background: rgba(94, 107, 58, 0.1);
            padding: 6px 16px;
            border-radius: 20px;
        }
        
        .onboarding-content {
            flex: 1;
            padding: 20px 24px;
            
            flex-direction: column;
            overflow-y: auto;
        }
        
        .onboarding-question {
            margin-bottom: 32px;
        }
        
        .onboarding-question h2 {
            font-size: 24px;
            font-weight: 700;
            color: #3D4A2D;
            line-height: 1.4;
            margin-bottom: 8px;
        }
        
        .onboarding-question p {
            font-size: 14px;
            color: #666;
        }
        
        .onboarding-options {
            
            flex-direction: column;
            gap: 12px;
        }
        
        .onboarding-option {
            
            
            gap: 14px;
            padding: 18px 20px;
            background: white;
            border: 2px solid #E8E8E8;
            border-radius: 16px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: left;
            font-family: inherit;
        }
        
        .onboarding-option:hover {
            border-color: #5E6B3A;
            background: rgba(94, 107, 58, 0.03);
        }
        
        .onboarding-option.selected {
            border-color: #5E6B3A;
            background: rgba(94, 107, 58, 0.08);
        }
        
        .onboarding-option .option-icon {
            font-size: 24px;
        }
        
        .onboarding-option .option-text {
            flex: 1;
        }
        
        .onboarding-option .option-text strong {
            display: block;
            font-size: 16px;
            font-weight: 600;
            color: #3D4A2D;
            margin-bottom: 2px;
        }
        
        .onboarding-option .option-text span {
            font-size: 13px;
            color: #888;
        }
        
        .onboarding-input {
            width: 100%;
            padding: 18px 20px;
            border: 2px solid #E8E8E8;
            border-radius: 16px;
            font-size: 16px;
            font-family: inherit;
            transition: border-color 0.2s;
        }
        
        .onboarding-input:focus {
            outline: none;
            border-color: #5E6B3A;
        }
        
        .onboarding-input::placeholder {
            color: #AAA;
        }
        
        .onboarding-next-btn {
            margin-top: auto;
            padding: 18px;
            background: #5E6B3A;
            color: white;
            border: none;
            border-radius: 16px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
        }
        
        .onboarding-next-btn:hover {
            background: #4A5530;
        }
        
        .onboarding-next-btn:disabled {
            background: #CCC;
            cursor: not-allowed;
        }
        
        /* ==================== Ï±ÑÌåÖ ÌôîÎ©¥ ==================== */
        .chat-screen {
            background: #FDF8F5;
            
            flex-direction: column;
        }
        
        .chat-header {
            
            
            justify-content: space-between;
            padding: 50px 16px 16px;
            background: white;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .chat-title {
            
            
            gap: 8px;
            font-size: 17px;
            font-weight: 600;
            color: #3D4A2D;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px 16px;
            overflow-y: auto;
            
            flex-direction: column;
            gap: 16px;
        }
        
        .message {
            
            gap: 10px;
            max-width: 85%;
        }
        
        .message.bot {
            align-self: flex-start;
        }
        
        .message.user {
            align-self: flex-end;
            flex-direction: row-reverse;
        }
        
        .message-avatar {
            width: 36px;
            height: 36px;
            background: white;
            border-radius: 50%;
            
            
            
            font-size: 18px;
            flex-shrink: 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }
        
        .message-content {
            background: white;
            padding: 12px 16px;
            border-radius: 18px;
            box-shadow: 0 1px 4px rgba(0,0,0,0.06);
        }
        
        .message.user .message-content {
            background: #5E6B3A;
            color: white;
        }
        
        .message-content p {
            font-size: 14px;
            line-height: 1.5;
            margin: 0;
        }
        
        .message-content p + p {
            margin-top: 6px;
        }
        
        .chat-input-area {
            
            gap: 10px;
            padding: 12px 16px 32px;
            background: white;
            border-top: 1px solid #f0f0f0;
        }
        
        .chat-input {
            flex: 1;
            padding: 12px 16px;
            border: 1px solid #E8E8E8;
            border-radius: 24px;
            font-size: 15px;
            outline: none;
            font-family: inherit;
        }
        
        .chat-input:focus {
            border-color: #5E6B3A;
        }
        
        .send-btn {
            width: 44px;
            height: 44px;
            background: #5E6B3A;
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            
            
            
            transition: background 0.2s;
        }
        
        .send-btn:hover {
            background: #3D4A2D;
        }
        
        /* ÎßàÏù¥ÌÅ¨ Î≤ÑÌäº */
        .mic-btn {
            width: 44px;
            height: 44px;
            background: #3D3D3D;
            border: none;
            border-radius: 50%;
            color: white;
            cursor: pointer;
            
            
            
            transition: all 0.3s;
            flex-shrink: 0;
        }
        
        .mic-btn:hover {
            background: #5E6B3A;
        }
        
        .mic-btn.recording {
            background: #5E6B3A;
            animation: pulse-mic 1.5s infinite;
        }
        
        @keyframes pulse-mic {
            0%, 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(94, 107, 58, 0.4); }
            50% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(94, 107, 58, 0); }
        }
        
        /* ÏùåÌåå ÏïÑÏù¥ÏΩò */
        .sound-wave {
            
            
            
            gap: 2px;
            height: 20px;
        }
        
        .sound-wave .bar {
            width: 3px;
            height: 8px;
            background: white;
            border-radius: 2px;
            transition: height 0.1s;
        }
        
        .mic-btn.recording .sound-wave .bar {
            animation: wave-bar 0.6s ease-in-out infinite;
        }
        
        .mic-btn.recording .sound-wave .bar:nth-child(1) { animation-delay: 0s; }
        .mic-btn.recording .sound-wave .bar:nth-child(2) { animation-delay: 0.1s; }
        .mic-btn.recording .sound-wave .bar:nth-child(3) { animation-delay: 0.2s; }
        .mic-btn.recording .sound-wave .bar:nth-child(4) { animation-delay: 0.1s; }
        .mic-btn.recording .sound-wave .bar:nth-child(5) { animation-delay: 0s; }
        
        @keyframes wave-bar {
            0%, 100% { height: 8px; }
            50% { height: 18px; }
        }
        
        /* ÎÖπÏùå Ï§ë Ïù∏ÎîîÏºÄÏù¥ÌÑ∞ */
        .recording-indicator {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(94, 107, 58, 0.95);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 13px;
            white-space: nowrap;
            margin-bottom: 10px;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s;
            
            
            gap: 8px;
        }
        
        .recording-indicator.active {
            opacity: 1;
            visibility: visible;
        }
        
        .recording-indicator::after {
            content: '';
            position: absolute;
            bottom: -6px;
            left: 50%;
            transform: translateX(-50%);
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 6px solid rgba(94, 107, 58, 0.95);
        }
        
        .recording-dot {
            width: 8px;
            height: 8px;
            background: #FF6B6B;
            border-radius: 50%;
            animation: blink-dot 1s infinite;
        }
        
        @keyframes blink-dot {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.3; }
        }
        
        /* Ï±ÑÌåÖ ÏûÖÎ†• ÏòÅÏó≠ ÏàòÏ†ï */
        .chat-input-area {
            position: relative;
        }
        
        /* ==================== Í≥µÌÜµ Ìó§Îçî ==================== */
        .screen-header {
            
            
            justify-content: space-between;
            padding: 50px 16px 16px;
            background: white;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .screen-title {
            font-size: 18px;
            font-weight: 600;
            color: #3D4A2D;
        }
        
        .menu-btn {
            width: 40px;
            height: 40px;
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: #5E6B3A;
        }
        
        /* ==================== Ï∫òÎ¶∞Îçî ÌôîÎ©¥ ==================== */
        .calendar-screen {
            background: #FDF8F5;
            
            flex-direction: column;
        }
        
        .calendar-content {
            flex: 1;
            padding: 20px 16px;
            overflow-y: auto;
            padding-bottom: calc(100px + env(safe-area-inset-bottom, 0px));
        }
        
        .calendar-nav {
            
            
            justify-content: space-between;
            margin-bottom: 20px;
        }
        
        .calendar-nav button {
            width: 36px;
            height: 36px;
            background: white;
            border: none;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            color: #5E6B3A;
        }
        
        .calendar-month {
            font-size: 18px;
            font-weight: 600;
            color: #3D4A2D;
        }
        
        .calendar-weekdays {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            text-align: center;
            margin-bottom: 10px;
        }
        
        .calendar-weekdays span {
            font-size: 12px;
            color: #8A8A8A;
            padding: 8px 0;
        }
        
        .calendar-weekdays span:first-child { color: #E8B4B8; }
        .calendar-weekdays span:last-child { color: #5E6B3A; }
        
        .calendar-days {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 4px;
            margin-bottom: 24px;
        }
        
        .calendar-day {
            aspect-ratio: 1;
            
            
            
            font-size: 14px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .calendar-day:hover { background: rgba(94, 107, 58, 0.1); }
        .calendar-day.today { background: #5E6B3A; color: white; font-weight: 600; }
        .calendar-day.has-event::after {
            content: '';
            position: absolute;
            bottom: 4px;
            width: 4px;
            height: 4px;
            background: #E8B4B8;
            border-radius: 50%;
        }
        .calendar-day { position: relative; }
        
        .calendar-events h3 {
            font-size: 16px;
            font-weight: 600;
            color: #3D4A2D;
            margin-bottom: 12px;
        }
        
        .event-item {
            
            
            gap: 12px;
            background: white;
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        
        .event-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            flex-shrink: 0;
        }
        
        .event-title {
            font-size: 14px;
            font-weight: 500;
            color: #3D4A2D;
        }
        
        .event-time {
            font-size: 12px;
            color: #8A8A8A;
            margin-top: 2px;
        }
        
        /* ==================== ÎßàÏù¥ÌéòÏù¥ÏßÄ ÌôîÎ©¥ ==================== */
        .my-screen {
            background: #FDF8F5;
            
            flex-direction: column;
        }
        
        .my-content {
            flex: 1;
            padding: 20px 16px;
            overflow-y: auto;
            padding-bottom: calc(100px + env(safe-area-inset-bottom, 0px));
        }
        
        .profile-section {
            
            
            gap: 16px;
            background: white;
            padding: 0;
            border-radius: 16px;
            margin-bottom: 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
        }
        
        .profile-avatar {
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #E8B4B8, #F0D0D3);
            border-radius: 50%;
            
            
            
            font-size: 28px;
        }
        
        .profile-info {
            flex: 1;
        }
        
        .profile-info h2 {
            font-size: 18px;
            font-weight: 600;
            color: #3D4A2D;
        }
        
        .profile-info p {
            font-size: 13px;
            color: #8A8A8A;
            margin-top: 4px;
        }
        
        .profile-info strong { color: #5E6B3A; }
        
        .edit-btn {
            padding: 8px 16px;
            background: rgba(94, 107, 58, 0.1);
            border: none;
            border-radius: 20px;
            color: #5E6B3A;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
        }
        
        .my-stats {
            
            gap: 12px;
            margin-bottom: 24px;
        }
        
        .stat-item {
            flex: 1;
            background: white;
            padding: 16px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        
        .stat-num {
            display: block;
            font-size: 24px;
            font-weight: 700;
            color: #5E6B3A;
        }
        
        .stat-label {
            font-size: 12px;
            color: #8A8A8A;
        }
        
        .my-menu-list {
            background: white;
            border-radius: 16px;
            overflow: hidden;
            box-shadow: 0 2px 12px rgba(0,0,0,0.06);
        }
        
        .my-menu-item {
            
            
            width: 100%;
            padding: 16px 20px;
            background: none;
            border: none;
            border-bottom: 1px solid #f5f5f5;
            cursor: pointer;
            text-align: left;
            font-size: 15px;
            color: #3D4A2D;
            gap: 12px;
        }
        
        .my-menu-item:last-child { border-bottom: none; }
        .menu-icon { font-size: 18px; }
        .menu-arrow { margin-left: auto; color: #BDBDBD; }
        
        /* ==================== ÏïåÎ¶º ÌôîÎ©¥ ==================== */
        .notification-screen {
            background: #FDF8F5;
            
            flex-direction: column;
        }
        
        .noti-content {
            flex: 1;
            padding: 16px;
            overflow-y: auto;
        }
        
        .noti-item {
            
            gap: 12px;
            background: white;
            padding: 16px;
            border-radius: 12px;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.04);
        }
        
        .noti-item.unread {
            background: linear-gradient(135deg, #fff 0%, #f8fff5 100%);
            border-left: 3px solid #5E6B3A;
        }
        
        .noti-icon {
            width: 40px;
            height: 40px;
            background: #f5f5f5;
            border-radius: 50%;
            
            
            
            font-size: 18px;
            flex-shrink: 0;
        }
        
        .noti-title {
            font-size: 14px;
            font-weight: 500;
            color: #3D4A2D;
        }
        
        .noti-desc {
            font-size: 13px;
            color: #666;
            margin-top: 4px;
        }
        
        .noti-time {
            font-size: 11px;
            color: #BDBDBD;
            margin-top: 6px;
        }
        
        /* ==================== ÏÇ¨Ïù¥Îìú Î©îÎâ¥ ==================== */
        .side-menu {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 200;
        }
        
        .side-menu.hidden { display: none; }
        
        .side-menu-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.4);
        }
        
        .side-menu-content {
            position: absolute;
            top: 0;
            left: 0;
            width: 280px;
            height: 100%;
            background: white;
            border-radius: 0 24px 24px 0;
            overflow: hidden;
            animation: slideIn 0.3s ease;
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); }
            to { transform: translateX(0); }
        }
        
        .side-menu-header {
            
            
            justify-content: space-between;
            padding: 60px 20px 20px;
            background: linear-gradient(135deg, #5E6B3A, #7A8B4A);
            color: white;
        }
        
        .side-profile {
            
            
            gap: 12px;
        }
        
        .side-avatar {
            width: 48px;
            height: 48px;
            background: rgba(255,255,255,0.2);
            border-radius: 50%;
            
            
            
            font-size: 22px;
        }
        
        .side-name {
            font-size: 16px;
            font-weight: 600;
        }
        
        .side-email {
            font-size: 12px;
            opacity: 0.8;
        }
        
        .close-menu-btn {
            width: 32px;
            height: 32px;
            background: rgba(255,255,255,0.2);
            border: none;
            border-radius: 50%;
            color: white;
            font-size: 16px;
            cursor: pointer;
        }
        
        .side-menu-list {
            padding: 16px 0;
        }
        
        .side-menu-item {
            
            
            gap: 14px;
            width: 100%;
            padding: 14px 24px;
            background: none;
            border: none;
            font-size: 15px;
            color: #3D4A2D;
            cursor: pointer;
            text-align: left;
        }
        
        .side-menu-item:hover {
            background: rgba(94, 107, 58, 0.08);
        }
        
        .side-icon { font-size: 18px; }
        
        .side-divider {
            height: 1px;
            background: #FDF8F3;
            margin: 12px 24px;
        }
        
        /* ==================== RAG ÏùëÎãµ Ïä§ÌÉÄÏùº ==================== */
        .typing-indicator {
            color: #8A8A8A;
            font-style: italic;
        }
        
        .typing-indicator .dots {
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { opacity: 1; }
            51%, 100% { opacity: 0; }
        }
        
        .answer-title {
            color: #5E6B3A;
            font-size: 15px;
            margin-bottom: 8px !important;
        }
        
        .related-topics {
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid #f0f0f0;
        }
        
        .related-label {
            font-size: 12px;
            color: #8A8A8A;
            margin-bottom: 8px !important;
        }
        
        .related-btn {
            display: inline-block;
            padding: 6px 12px;
            margin: 4px 4px 4px 0;
            background: #F0F2E8;
            border: 1px solid #D5DAC7;
            border-radius: 16px;
            font-size: 12px;
            color: #5E6B3A;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .related-btn:hover {
            background: #5E6B3A;
            color: white;
            border-color: #5E6B3A;
        }
        
        .related-btn:active {
            transform: scale(0.95);
        }
    </style>
</head>
<body>
    <div class="iphone-frame">
        <div class="notch"></div>
        
        <div class="screen">
            <!-- Ïù∏Ìä∏Î°ú ÌôîÎ©¥ -->
            <div class="page intro-screen" id="introScreen">
                <div class="intro-bg">
                    <img src="intro-bg.png" alt="Î∞∞Í≤Ω">
                </div>
                <div class="intro-overlay"></div>
                
                <div class="intro-content">
                    <div class="intro-logo">
                        <div class="intro-logo-icon">ü§±</div>
                        <div class="intro-brand">ÎßòÍ≥Å MOMGYEOT</div>
                    </div>
                    
                    <div class="intro-headline">
                        <h1>
                            <span class="typing-line line1">ÏïÑÍ∏∞Î•º ÌíàÏùÄ ÏóÑÎßà,</span>
                            <span class="typing-line line2">Í∑∏ Í≥ÅÏùÑ ÏßÄÌÇ§Îäî ÏïÑÎπ†,</span>
                            <span class="typing-line line3">Í∑∏ ÎëòÏùÑ Î∞õÏ≥êÏ£ºÎäî <span class="highlight">ÎßòÍ≥Å</span>.</span>
                        </h1>
                    </div>
                    
                    <p class="intro-subtitle">
                        <span class="heart-text">ÏïÑÏù¥ÎßåÏù¥ ÏïÑÎãàÎùº, Î∂ÄÎ™®Ïùò ÎßàÏùåÍπåÏßÄ</span><br>
                        <span class="heart-text">Ìï®Íªò ÎèåÎ≥¥Îäî ÎèôÎ∞òÏûêÍ∞Ä ÎêòÍ≥† Ïã∂Ïñ¥Ïöî. üíï</span>
                    </p>
                    
                    <div class="intro-cta">
                        <button class="intro-btn" onclick="showLogin()">
                            ÏãúÏûëÌïòÍ∏∞ <span>‚Üí</span>
                        </button>
                    </div>
                    
                    <div class="intro-footer">¬© 2026 ÎßòÍ≥Å Momgyeot</div>
                </div>
            </div>
            
            <!-- Î°úÍ∑∏Ïù∏ ÌôîÎ©¥ -->
            <div class="page login-screen hidden" id="loginScreen">
                <div class="login-header">
                    <button class="back-btn" onclick="showIntro()">‚Üê</button>
                    
                    <div class="login-logo">
                        <div class="login-logo-icon">ü§±</div>
                        <h2 class="login-title">ÎßòÍ≥ÅÏóê Ïò§Ïã† Í≤ÉÏùÑ<br>ÌôòÏòÅÌï¥Ïöî</h2>
                        <p class="login-desc">Í∞ÑÌé∏ÌïòÍ≤å Î°úÍ∑∏Ïù∏ÌïòÍ≥† ÏãúÏûëÌïòÏÑ∏Ïöî</p>
                    </div>
                </div>
                
                <div class="login-buttons">
                    <button class="login-btn login-btn-kakao" onclick="loginWith('kakao')">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 3C6.5 3 2 6.58 2 11c0 2.84 1.86 5.33 4.64 6.77l-.96 3.56c-.08.3.23.55.5.4l4.13-2.73c.56.06 1.12.1 1.69.1 5.5 0 10-3.58 10-8S17.5 3 12 3z"/>
                        </svg>
                        Ïπ¥Ïπ¥Ïò§Î°ú ÏãúÏûëÌïòÍ∏∞
                    </button>
                    
                    <button class="login-btn login-btn-google" onclick="loginWith('google')">
                        <svg class="btn-icon" viewBox="0 0 24 24">
                            <path fill="#4285F4" d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"/>
                            <path fill="#34A853" d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"/>
                            <path fill="#FBBC05" d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"/>
                            <path fill="#EA4335" d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"/>
                        </svg>
                        GoogleÎ°ú Í≥ÑÏÜçÌïòÍ∏∞
                    </button>
                    
                    <button class="login-btn login-btn-apple" onclick="loginWith('apple')">
                        <svg class="btn-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M17.05 20.28c-.98.95-2.05.8-3.08.35-1.09-.46-2.09-.48-3.24 0-1.44.62-2.2.44-3.06-.35C2.79 15.25 3.51 7.59 9.05 7.31c1.35.07 2.29.74 3.08.8 1.18-.24 2.31-.93 3.57-.84 1.51.12 2.65.72 3.4 1.8-3.12 1.87-2.38 5.98.48 7.13-.57 1.5-1.31 2.99-2.54 4.09l.01-.01zM12.03 7.25c-.15-2.23 1.66-4.07 3.74-4.25.29 2.58-2.34 4.5-3.74 4.25z"/>
                        </svg>
                        AppleÎ°ú Í≥ÑÏÜçÌïòÍ∏∞
                    </button>
                    
                    <div class="divider">
                        <div class="divider-line"></div>
                        <span class="divider-text">ÎòêÎäî</span>
                        <div class="divider-line"></div>
                    </div>
                    
                    <button class="login-btn login-btn-guest" onclick="guestLogin()">
                        Î°úÍ∑∏Ïù∏ ÏóÜÏù¥ ÎëòÎü¨Î≥¥Í∏∞
                    </button>
                </div>
            </div>
            
            <!-- Ìôà ÌôîÎ©¥ -->
            <div class="page home-screen hidden" id="homeScreen">
                <div class="home-header">
                    <button class="menu-btn" type="button" id="homeMenuBtn">‚ò∞</button>
                    <div class="home-greeting">
                        <span class="greeting-emoji">üëã</span>
                        <div>
                            <p class="greeting-text">ÏïàÎÖïÌïòÏÑ∏Ïöî!</p>
                            <p class="greeting-name" id="userName">Í≤åÏä§Ìä∏Îãò</p>
                        </div>
                    </div>
                    <div class="home-icons">
                        <button class="icon-btn" type="button" id="homeNotiBtn">üîî</button>
                    </div>
                </div>
                
                <div class="home-content">
                    <h2 class="section-title">ÎßòÍ≥Å ÏÑ†ÌÉùÌïòÍ∏∞</h2>
                    <p class="section-desc">ÎÇòÏóêÍ≤å ÎßûÎäî ÎßòÍ≥ÅÏùÑ ÏÑ†ÌÉùÌï¥Ï£ºÏÑ∏Ïöî</p>
                    
                    <div class="mate-cards">
                        <button class="mate-card" type="button" id="cardSaessak">
                            <span class="mate-tag">ÏûÑÏã†Ï§ÄÎπÑ</span>
                            <div class="mate-icon">üå±</div>
                            <h3>ÏòàÎπÑÎßòÍ≥Å</h3>
                            <p>ÏûÑÏã†ÏùÑ Ï§ÄÎπÑÌïòÎäî<br>ÏòàÎπÑ ÏóÑÎßàÎ•º ÏúÑÌï¥</p>
                        </button>
                        
                        <button class="mate-card" type="button" id="cardYebi">
                            <span class="mate-tag">ÏûÑÏã†Ï§ë</span>
                            <div class="mate-icon">ü§∞</div>
                            <h3>ÏûÑÏã†ÎßòÍ≥Å</h3>
                            <p>ÏÜåÏ§ëÌïú ÏÉùÎ™ÖÍ≥º Ìï®ÍªòÌïòÎäî<br>ÏûÑÏã† Í∏∞Í∞Ñ ÎèôÏïà</p>
                        </button>
                        
                        <button class="mate-card" type="button" id="cardAgi">
                            <span class="mate-tag">Ï∂úÏÇ∞ÌõÑ</span>
                            <div class="mate-icon">üë∂</div>
                            <h3>Ï¥àÎ≥¥ÎßòÍ≥Å</h3>
                            <p>ÏïÑÍ∏∞ÏôÄ Ìï®ÍªòÌïòÎäî<br>Ïú°ÏïÑÏùò Î™®Îì† ÏàúÍ∞Ñ</p>
                        </button>
                        
                        <button class="mate-card" type="button" id="cardExpert">
                            <span class="mate-tag">Ï†ÑÎ¨∏ÏÉÅÎã¥</span>
                            <div class="mate-icon">üë©‚Äç‚öïÔ∏è</div>
                            <h3>Ï†ÑÎ¨∏Í∞Ä Ïó∞Í≤∞</h3>
                            <p>Ï†ÑÎ¨∏ ÏÉÅÎã¥Ïù¥<br>ÌïÑÏöîÌï† Îïå</p>
                        </button>
                    </div>
                </div>
                
                <!-- ÌïòÎã® ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò -->
                <div class="bottom-nav">
                    <button class="nav-item active" type="button" id="navHome">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/>
                        </svg>
                        <span>Ìôà</span>
                    </button>
                    <button class="nav-item" type="button" id="navCalendar">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/>
                        </svg>
                        <span>Ï∫òÎ¶∞Îçî</span>
                    </button>
                    <button class="nav-item" type="button" id="navChat">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/>
                        </svg>
                        <span>Ï±ÑÌåÖ</span>
                    </button>
                    <button class="nav-item" type="button" id="navMy">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                        </svg>
                        <span>ÎßàÏù¥</span>
                    </button>
                </div>
            </div>
            
            <!-- Ïò®Î≥¥Îî© ÌôîÎ©¥ -->
            <div class="page onboarding-screen hidden" id="onboardingScreen">
                <div class="onboarding-header">
                    <button class="back-btn" type="button" id="onboardingBackBtn">‚Üê</button>
                    <div class="onboarding-progress">
                        <span id="onboardingStep">1</span> / <span id="onboardingTotal">3</span>
                    </div>
                    <div style="width: 40px;"></div>
                </div>
                
                <div class="onboarding-content" id="onboardingContent">
                    <!-- ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê® -->
                </div>
            </div>
            
            <!-- Ï±ÑÌåÖ ÌôîÎ©¥ -->
            <div class="page chat-screen hidden" id="chatScreen">
                <div class="chat-header">
                    <button class="back-btn" type="button" id="chatBackBtn">‚Üê</button>
                    <div class="chat-title">
                        <span id="chatMateIcon">üå±</span>
                        <span id="chatMateName">ÏòàÎπÑÎßòÍ≥Å</span>
                    </div>
                    <div style="width: 40px;"></div>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <div class="message bot">
                        <div class="message-avatar">ü§±</div>
                        <div class="message-content">
                            <p>ÏïàÎÖïÌïòÏÑ∏Ïöî! ÎßòÍ≥ÅÏù¥ÏóêÏöî üòä</p>
                            <p>Î¨¥ÏóáÏù¥Îì† Ìé∏ÌïòÍ≤å Î¨ºÏñ¥Î≥¥ÏÑ∏Ïöî.</p>
                        </div>
                    </div>
                </div>
                
                <div class="chat-input-area">
                    <div class="recording-indicator" id="recordingIndicator">
                        <span class="recording-dot"></span>
                        Îì£Í≥† ÏûàÏñ¥Ïöî...
                    </div>
                    <input type="text" class="chat-input" placeholder="Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî..." id="chatInput">
                    <button class="mic-btn" type="button" id="micBtn" aria-label="ÏùåÏÑ± ÏûÖÎ†•">
                        <div class="sound-wave">
                            <span class="bar"></span>
                            <span class="bar"></span>
                            <span class="bar"></span>
                            <span class="bar"></span>
                            <span class="bar"></span>
                        </div>
                    </button>
                    <button class="send-btn" type="button" id="sendBtn">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/>
                        </svg>
                    </button>
                </div>
            </div>
            
            <!-- Ï∫òÎ¶∞Îçî ÌôîÎ©¥ -->
            <div class="page calendar-screen hidden" id="calendarScreen">
                <div class="screen-header">
                    <button class="menu-btn" type="button" id="calMenuBtn">‚ò∞</button>
                    <h1 class="screen-title">Ï∫òÎ¶∞Îçî</h1>
                    <button class="icon-btn" type="button" id="calNotiBtn">üîî</button>
                </div>
                
                <div class="calendar-content">
                    <div class="calendar-nav">
                        <button type="button" id="prevMonth">‚Äπ</button>
                        <span class="calendar-month" id="currentMonth">2026ÎÖÑ 1Ïõî</span>
                        <button type="button" id="nextMonth">‚Ä∫</button>
                    </div>
                    
                    <div class="calendar-weekdays">
                        <span>Ïùº</span><span>Ïõî</span><span>Ìôî</span><span>Ïàò</span><span>Î™©</span><span>Í∏à</span><span>ÌÜ†</span>
                    </div>
                    
                    <div class="calendar-days" id="calendarDays">
                        <!-- ÏûêÎ∞îÏä§ÌÅ¨Î¶ΩÌä∏Î°ú ÏÉùÏÑ± -->
                    </div>
                    
                    <div class="calendar-events">
                        <h3>Ïò§ÎäòÏùò ÏùºÏ†ï</h3>
                        <div class="event-item">
                            <div class="event-dot" style="background: #E8B4B8;"></div>
                            <div class="event-info">
                                <p class="event-title">ÏÇ∞Î∂ÄÏù∏Í≥º Ï†ïÍ∏∞ Í≤ÄÏßÑ</p>
                                <p class="event-time">Ïò§ÌõÑ 2:00</p>
                            </div>
                        </div>
                        <div class="event-item">
                            <div class="event-dot" style="background: #5E6B3A;"></div>
                            <div class="event-info">
                                <p class="event-title">ÏûÑÏÇ∞Î∂Ä ÏöîÍ∞Ä ÏàòÏóÖ</p>
                                <p class="event-time">Ïò§ÌõÑ 4:30</p>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="bottom-nav">
                    <button class="nav-item" type="button" id="calNavHome"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg><span>Ìôà</span></button>
                    <button class="nav-item active" type="button" id="calNavCalendar"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11z"/></svg><span>Ï∫òÎ¶∞Îçî</span></button>
                    <button class="nav-item" type="button" id="calNavChat"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg><span>Ï±ÑÌåÖ</span></button>
                    <button class="nav-item" type="button" id="calNavMy"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg><span>ÎßàÏù¥</span></button>
                </div>
            </div>
            
            <!-- ÎßàÏù¥ÌéòÏù¥ÏßÄ ÌôîÎ©¥ -->
            <div class="page my-screen hidden" id="myScreen">
                <div class="screen-header">
                    <button class="menu-btn" type="button" id="myMenuBtn">‚ò∞</button>
                    <h1 class="screen-title">ÎßàÏù¥ÌéòÏù¥ÏßÄ</h1>
                    <button class="icon-btn" type="button" id="myNotiBtn">üîî</button>
                </div>
                
                <div class="my-content">
                    <div class="profile-section">
                        <div class="profile-avatar">üë©</div>
                        <div class="profile-info">
                            <h2 id="profileName">Í≤åÏä§Ìä∏Îãò</h2>
                            <p>ÎßòÍ≥ÅÍ≥º Ìï®ÍªòÌïú ÏßÄ <strong>1Ïùº</strong></p>
                        </div>
                        <button class="edit-btn" type="button">Ìé∏Ïßë</button>
                    </div>
                    
                    <div class="my-stats">
                        <div class="stat-item">
                            <span class="stat-num">3</span>
                            <span class="stat-label">ÎåÄÌôî Ïàò</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-num">1</span>
                            <span class="stat-label">Ï†ÄÏû•Îê®</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-num">0</span>
                            <span class="stat-label">ÏùºÏ†ï</span>
                        </div>
                    </div>
                    
                    <div class="my-menu-list">
                        <button class="my-menu-item" type="button">
                            <span class="menu-icon">üìã</span>
                            <span>ÎÇ¥ Ï†ïÎ≥¥ Í¥ÄÎ¶¨</span>
                            <span class="menu-arrow">‚Ä∫</span>
                        </button>
                        <button class="my-menu-item" type="button">
                            <span class="menu-icon">üí¨</span>
                            <span>ÎåÄÌôî Í∏∞Î°ù</span>
                            <span class="menu-arrow">‚Ä∫</span>
                        </button>
                        <button class="my-menu-item" type="button">
                            <span class="menu-icon">‚≠ê</span>
                            <span>Ï†ÄÏû•Ìïú ÎãµÎ≥Ä</span>
                            <span class="menu-arrow">‚Ä∫</span>
                        </button>
                        <button class="my-menu-item" type="button">
                            <span class="menu-icon">‚öôÔ∏è</span>
                            <span>ÏÑ§Ï†ï</span>
                            <span class="menu-arrow">‚Ä∫</span>
                        </button>
                        <button class="my-menu-item" type="button">
                            <span class="menu-icon">‚ùì</span>
                            <span>ÎèÑÏõÄÎßê</span>
                            <span class="menu-arrow">‚Ä∫</span>
                        </button>
                    </div>
                </div>
                
                <div class="bottom-nav">
                    <button class="nav-item" type="button" id="myNavHome"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg><span>Ìôà</span></button>
                    <button class="nav-item" type="button" id="myNavCalendar"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11z"/></svg><span>Ï∫òÎ¶∞Îçî</span></button>
                    <button class="nav-item" type="button" id="myNavChat"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2z"/></svg><span>Ï±ÑÌåÖ</span></button>
                    <button class="nav-item active" type="button" id="myNavMy"><svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg><span>ÎßàÏù¥</span></button>
                </div>
            </div>
            
            <!-- ÏïåÎ¶º ÌôîÎ©¥ -->
            <div class="page notification-screen hidden" id="notificationScreen">
                <div class="screen-header">
                    <button class="back-btn" type="button" id="notiBackBtn">‚Üê</button>
                    <h1 class="screen-title">ÏïåÎ¶º</h1>
                    <div style="width: 40px;"></div>
                </div>
                
                <div class="noti-content">
                    <div class="noti-item unread">
                        <div class="noti-icon">üí¨</div>
                        <div class="noti-info">
                            <p class="noti-title">ÏòàÎπÑÎßòÍ≥ÅÏóêÏÑú ÎãµÎ≥ÄÏù¥ ÎèÑÏ∞©ÌñàÏñ¥Ïöî</p>
                            <p class="noti-desc">ÏûÑÏã† Ï§ÄÎπÑÏóê ÎåÄÌïú ÎãµÎ≥ÄÏùÑ ÌôïÏù∏Ìï¥Î≥¥ÏÑ∏Ïöî.</p>
                            <p class="noti-time">Î∞©Í∏à Ï†Ñ</p>
                        </div>
                    </div>
                    <div class="noti-item unread">
                        <div class="noti-icon">üìÖ</div>
                        <div class="noti-info">
                            <p class="noti-title">ÎÇ¥Ïùº ÏùºÏ†ïÏù¥ ÏûàÏñ¥Ïöî</p>
                            <p class="noti-desc">ÏÇ∞Î∂ÄÏù∏Í≥º Ï†ïÍ∏∞ Í≤ÄÏßÑ - Ïò§ÌõÑ 2:00</p>
                            <p class="noti-time">1ÏãúÍ∞Ñ Ï†Ñ</p>
                        </div>
                    </div>
                    <div class="noti-item">
                        <div class="noti-icon">üéâ</div>
                        <div class="noti-info">
                            <p class="noti-title">ÎßòÍ≥ÅÏóê Ïò§Ïã† Í≤ÉÏùÑ ÌôòÏòÅÌï¥Ïöî!</p>
                            <p class="noti-desc">ÎßòÍ≥ÅÍ≥º Ìï®Íªò Í±¥Í∞ïÌïú ÏûÑÏã† Ïó¨Ï†ïÏùÑ ÏãúÏûëÌïòÏÑ∏Ïöî.</p>
                            <p class="noti-time">Ïò§Îäò</p>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- ÏÇ¨Ïù¥Îìú Î©îÎâ¥ -->
            <div class="side-menu hidden" id="sideMenu">
                <div class="side-menu-overlay" id="sideMenuOverlay"></div>
                <div class="side-menu-content">
                    <div class="side-menu-header">
                        <div class="side-profile">
                            <div class="side-avatar">üë©</div>
                            <div>
                                <p class="side-name" id="sideName">Í≤åÏä§Ìä∏Îãò</p>
                                <p class="side-email">ÎßòÍ≥ÅÍ≥º Ìï®ÍªòÌï¥Ïöî üíï</p>
                            </div>
                        </div>
                        <button class="close-menu-btn" type="button" id="closeMenuBtn">‚úï</button>
                    </div>
                    
                    <div class="side-menu-list">
                        <button class="side-menu-item" type="button" id="sideHome">
                            <span class="side-icon">üè†</span>
                            <span>Ìôà</span>
                        </button>
                        <button class="side-menu-item" type="button" id="sideSaessak">
                            <span class="side-icon">üå±</span>
                            <span>ÏòàÎπÑÎßòÍ≥Å</span>
                        </button>
                        <button class="side-menu-item" type="button" id="sideYebi">
                            <span class="side-icon">ü§∞</span>
                            <span>ÏûÑÏã†ÎßòÍ≥Å</span>
                        </button>
                        <button class="side-menu-item" type="button" id="sideAgi">
                            <span class="side-icon">üë∂</span>
                            <span>Ï¥àÎ≥¥ÎßòÍ≥Å</span>
                        </button>
                        <button class="side-menu-item" type="button" id="sideExpert">
                            <span class="side-icon">üë©‚Äç‚öïÔ∏è</span>
                            <span>Ï†ÑÎ¨∏Í∞Ä Ïó∞Í≤∞</span>
                        </button>
                        
                        <div class="side-divider"></div>
                        
                        <button class="side-menu-item" type="button" id="sideCalendar">
                            <span class="side-icon">üìÖ</span>
                            <span>Ï∫òÎ¶∞Îçî</span>
                        </button>
                        <button class="side-menu-item" type="button" id="sideHistory">
                            <span class="side-icon">üí¨</span>
                            <span>ÎåÄÌôî Í∏∞Î°ù</span>
                        </button>
                        <button class="side-menu-item" type="button" id="sideSaved">
                            <span class="side-icon">‚≠ê</span>
                            <span>Ï†ÄÏû•Ìïú ÎãµÎ≥Ä</span>
                        </button>
                        
                        <div class="side-divider"></div>
                        
                        <button class="side-menu-item" type="button" id="sideSettings">
                            <span class="side-icon">‚öôÔ∏è</span>
                            <span>ÏÑ§Ï†ï</span>
                        </button>
                        <button class="side-menu-item" type="button" id="sideLogout">
                            <span class="side-icon">üö™</span>
                            <span>Î°úÍ∑∏ÏïÑÏõÉ</span>
                        </button>
                    </div>
                </div>
            </div>
            
            <div class="home-indicator"></div>
        </div>
    </div>
    
    <script>
        // ÌôîÎ©¥ Ï†ÑÌôò Ìï®ÏàòÎì§
        function hideAll() {
            document.getElementById('introScreen').classList.add('hidden');
            document.getElementById('loginScreen').classList.add('hidden');
            document.getElementById('homeScreen').classList.add('hidden');
            document.getElementById('onboardingScreen').classList.add('hidden');
            document.getElementById('chatScreen').classList.add('hidden');
            document.getElementById('calendarScreen').classList.add('hidden');
            document.getElementById('myScreen').classList.add('hidden');
            document.getElementById('notificationScreen').classList.add('hidden');
            closeSideMenu();
        }
        
        // Ïò®Î≥¥Îî© Îç∞Ïù¥ÌÑ∞
        var onboardingData = {
            saessak: {
                name: 'ÏòàÎπÑÎßòÍ≥Å',
                icon: 'üå±',
                questions: [
                    {
                        question: 'ÏûÑÏã† Ï§ÄÎπÑÎ•º ÏãúÏûëÌïú ÏßÄ\nÏñºÎßàÎÇò ÎêòÏÖ®ÎÇòÏöî?',
                        subtitle: 'ÎßûÏ∂§ Ï†ïÎ≥¥Î•º ÎìúÎ¶¨Í∏∞ ÏúÑÌï¥ Ïó¨Ï≠§Î¥êÏöî',
                        options: [
                            { icon: 'üåü', title: 'Ïù¥Ï†ú Îßâ ÏãúÏûëÌñàÏñ¥Ïöî', sub: '1Í∞úÏõî Ïù¥ÎÇ¥' },
                            { icon: 'üìÖ', title: 'Î™á Í∞úÏõî ÎêêÏñ¥Ïöî', sub: '1~6Í∞úÏõî' },
                            { icon: '‚è∞', title: 'ÍΩ§ ÏãúÍ∞ÑÏù¥ ÏßÄÎÇ¨Ïñ¥Ïöî', sub: '6Í∞úÏõî Ïù¥ÏÉÅ' },
                            { icon: 'ü§´', title: 'ÎßêÌïòÍ∏∞ Ïñ¥Î†§ÏõåÏöî', sub: '' }
                        ]
                    },
                    {
                        question: 'ÏßÄÍ∏à Í∞ÄÏû• Í∂ÅÍ∏àÌïòÍ±∞ÎÇò\nÌûòÎì† Î∂ÄÎ∂ÑÏù¥ ÏûàÎÇòÏöî?',
                        subtitle: '',
                        options: [
                            { icon: 'üìö', title: 'ÏûÑÏã† Ï§ÄÎπÑ Ï†ïÎ≥¥Í∞Ä Í∂ÅÍ∏àÌï¥Ïöî', sub: 'Í±¥Í∞ï, ÏòÅÏñë, Í≤ÄÏÇ¨ Îì±' },
                            { icon: 'üíù', title: 'ÎßàÏùåÏù¥ ÌûòÎì§Ïñ¥Ïöî', sub: 'Ï†ïÏÑúÏ†Å ÏßÄÏßÄÍ∞Ä ÌïÑÏöîÌï¥Ïöî' },
                            { icon: 'üíë', title: 'Î∂ÄÎ∂Ä Í¥ÄÍ≥ÑÍ∞Ä Í±±Ï†ïÎèºÏöî', sub: 'ÎåÄÌôî, ÏÜåÌÜµ' },
                            { icon: 'üè•', title: 'Î≥ëÏõê/ÏãúÏà† Ï†ïÎ≥¥Í∞Ä Í∂ÅÍ∏àÌï¥Ïöî', sub: '' }
                        ]
                    },
                    {
                        question: 'ÎßòÍ≥ÅÏù¥ Ïñ¥ÎñªÍ≤å\nÎ∂àÎü¨ÎìúÎ¶¥ÍπåÏöî?',
                        subtitle: 'Ìé∏ÌïòÍ≤å Î∂àÎü¨ÎìúÎ¶¥ Ïù¥Î¶ÑÏùÑ ÏïåÎ†§Ï£ºÏÑ∏Ïöî',
                        type: 'input',
                        placeholder: 'Ïòà: ÌïòÎäò, Î≥¥ÎØ∏, ÏóÑÎßà'
                    }
                ]
            },
            yebi: {
                name: 'ÏûÑÏã†ÎßòÍ≥Å',
                icon: 'ü§∞',
                questions: [
                    {
                        question: 'ÏßÄÍ∏à ÏûÑÏã† Î™á Ï£ºÏ∞®Ïù¥ÏÑ∏Ïöî?',
                        subtitle: 'ÎßûÏ∂§ Ï†ïÎ≥¥Î•º ÎìúÎ¶¨Í∏∞ ÏúÑÌï¥ Ïó¨Ï≠§Î¥êÏöî',
                        options: [
                            { icon: 'üå±', title: 'Ï¥àÍ∏∞ÏòàÏöî', sub: '1~12Ï£º' },
                            { icon: 'üåø', title: 'Ï§ëÍ∏∞ÏòàÏöî', sub: '13~27Ï£º' },
                            { icon: 'üå≥', title: 'ÌõÑÍ∏∞ÏòàÏöî', sub: '28Ï£º Ïù¥ÏÉÅ' },
                            { icon: '‚ùì', title: 'Ïûò Î™®Î•¥Í≤†Ïñ¥Ïöî', sub: '' }
                        ]
                    },
                    {
                        question: 'Ï≤´ ÏïÑÏù¥Ïù∏Í∞ÄÏöî?',
                        subtitle: '',
                        options: [
                            { icon: 'üë∂', title: 'ÎÑ§, Ï≤´ ÏïÑÏù¥ÏòàÏöî', sub: '' },
                            { icon: 'üë®‚Äçüë©‚Äçüëß', title: 'ÏïÑÎãàÏöî, ÎëòÏß∏ Ïù¥ÏÉÅÏù¥ÏóêÏöî', sub: '' }
                        ]
                    },
                    {
                        question: 'ÎßòÍ≥ÅÏù¥ Ïñ¥ÎñªÍ≤å\nÎ∂àÎü¨ÎìúÎ¶¥ÍπåÏöî?',
                        subtitle: 'ÌÉúÎ™ÖÏù¥ÎÇò ÎãâÎÑ§ÏûÑÏùÑ ÏïåÎ†§Ï£ºÏÑ∏Ïöî',
                        type: 'input',
                        placeholder: 'Ïòà: ÏΩ©Ïù¥Îßò, ÌïòÎäò, Î≥¥ÎØ∏'
                    }
                ]
            },
            agi: {
                name: 'Ï¥àÎ≥¥ÎßòÍ≥Å',
                icon: 'üë∂',
                questions: [
                    {
                        question: 'ÏïÑÍ∏∞Í∞Ä ÌÉúÏñ¥ÎÇú ÏßÄ\nÏñºÎßàÎÇò ÎêêÎÇòÏöî?',
                        subtitle: 'ÎßûÏ∂§ Ï†ïÎ≥¥Î•º ÎìúÎ¶¨Í∏∞ ÏúÑÌï¥ Ïó¨Ï≠§Î¥êÏöî',
                        options: [
                            { icon: 'üçº', title: 'Ïã†ÏÉùÏïÑÏòàÏöî', sub: '0~3Í∞úÏõî' },
                            { icon: 'üë∂', title: 'ÏïÑÏßÅ Ïñ¥Î†§Ïöî', sub: '4~6Í∞úÏõî' },
                            { icon: 'üßí', title: 'Ï°∞Í∏à Ïª∏Ïñ¥Ïöî', sub: '7~12Í∞úÏõî' },
                            { icon: 'üö∂', title: 'ÎèåÏù¥ ÏßÄÎÇ¨Ïñ¥Ïöî', sub: '12Í∞úÏõî Ïù¥ÏÉÅ' }
                        ]
                    },
                    {
                        question: 'ÏßÄÍ∏à Í∞ÄÏû• ÌûòÎì† Î∂ÄÎ∂ÑÏù¥\nÏûàÏúºÏã†Í∞ÄÏöî?',
                        subtitle: '',
                        options: [
                            { icon: 'ü§±', title: 'ÏàòÏú†Í∞Ä ÌûòÎì§Ïñ¥Ïöî', sub: 'Î™®Ïú†ÏàòÏú†, Î∂ÑÏú†, Ï†ñÎ≥ë' },
                            { icon: 'üò¥', title: 'ÏàòÎ©¥Ïù¥ Î∂ÄÏ°±Ìï¥Ïöî', sub: 'Î∞§ÏàòÏú†, Ïû†Ìà¨Ï†ï' },
                            { icon: 'üìà', title: 'Î∞úÎã¨Ïù¥ Í±±Ï†ïÎèºÏöî', sub: 'ÏÑ±Ïû•, Î∞úÎã¨ Ï≤¥ÌÅ¨' },
                            { icon: 'üí™', title: 'Ï≤¥Î†•Ïù¥ ÌûòÎì§Ïñ¥Ïöî', sub: 'ÏÇ∞ÌõÑÏ°∞Î¶¨, ÌöåÎ≥µ' }
                        ]
                    },
                    {
                        question: 'ÎßòÍ≥ÅÏù¥ Ïñ¥ÎñªÍ≤å\nÎ∂àÎü¨ÎìúÎ¶¥ÍπåÏöî?',
                        subtitle: 'Ìé∏ÌïòÍ≤å Î∂àÎü¨ÎìúÎ¶¥ Ïù¥Î¶ÑÏùÑ ÏïåÎ†§Ï£ºÏÑ∏Ïöî',
                        type: 'input',
                        placeholder: 'Ïòà: ÏΩ©Ïù¥Îßò, ÌïòÎäòÎßò'
                    }
                ]
            }
        };
        
        var currentOnboarding = {
            type: null,
            step: 0,
            answers: []
        };
        
        function startOnboarding(type) {
            currentOnboarding.type = type;
            currentOnboarding.step = 0;
            currentOnboarding.answers = [];
            
            hideAll();
            document.getElementById('onboardingScreen').classList.remove('hidden');
            
            var data = onboardingData[type];
            document.getElementById('onboardingTotal').textContent = data.questions.length;
            
            renderOnboardingStep();
        }
        
        function renderOnboardingStep() {
            var data = onboardingData[currentOnboarding.type];
            var question = data.questions[currentOnboarding.step];
            var container = document.getElementById('onboardingContent');
            
            document.getElementById('onboardingStep').textContent = currentOnboarding.step + 1;
            
            var html = '<div class="onboarding-question">';
            html += '<h2>' + question.question.replace(/\n/g, '<br>') + '</h2>';
            if (question.subtitle) {
                html += '<p>' + question.subtitle + '</p>';
            }
            html += '</div>';
            
            if (question.type === 'input') {
                html += '<input type="text" class="onboarding-input" placeholder="' + question.placeholder + '" id="onboardingInput">';
                html += '<button class="onboarding-next-btn" id="onboardingNextBtn" disabled>ÏôÑÎ£å</button>';
            } else {
                html += '<div class="onboarding-options">';
                question.options.forEach(function(opt, idx) {
                    html += '<button class="onboarding-option" type="button" data-idx="' + idx + '">';
                    html += '<span class="option-icon">' + opt.icon + '</span>';
                    html += '<div class="option-text">';
                    html += '<strong>' + opt.title + '</strong>';
                    if (opt.sub) {
                        html += '<span>' + opt.sub + '</span>';
                    }
                    html += '</div>';
                    html += '</button>';
                });
                html += '</div>';
            }
            
            container.innerHTML = html;
            
            // Ïù¥Î≤§Ìä∏ Î∞îÏù∏Îî©
            if (question.type === 'input') {
                var input = document.getElementById('onboardingInput');
                var btn = document.getElementById('onboardingNextBtn');
                
                input.addEventListener('input', function() {
                    btn.disabled = input.value.trim() === '';
                });
                
                btn.addEventListener('click', function() {
                    currentOnboarding.answers.push(input.value.trim());
                    finishOnboarding();
                });
                
                input.focus();
            } else {
                var options = container.querySelectorAll('.onboarding-option');
                options.forEach(function(opt) {
                    opt.addEventListener('click', function() {
                        var idx = parseInt(opt.getAttribute('data-idx'));
                        currentOnboarding.answers.push(question.options[idx].title);
                        
                        opt.classList.add('selected');
                        
                        setTimeout(function() {
                            if (currentOnboarding.step < onboardingData[currentOnboarding.type].questions.length - 1) {
                                currentOnboarding.step++;
                                renderOnboardingStep();
                            } else {
                                finishOnboarding();
                            }
                        }, 300);
                    });
                });
            }
        }
        
        function finishOnboarding() {
            var data = onboardingData[currentOnboarding.type];
            var nickname = currentOnboarding.answers[currentOnboarding.answers.length - 1] || 'Îßò';
            
            // Ï±ÑÌåÖ ÌôîÎ©¥ÏúºÎ°ú Ïù¥Îèô
            showChatWithContext(currentOnboarding.type, data.icon, data.name, nickname, currentOnboarding.answers);
        }
        
        function showChatWithContext(type, icon, name, nickname, answers) {
            hideAll();
            document.getElementById('chatMateIcon').textContent = icon;
            document.getElementById('chatMateName').textContent = name;
            document.getElementById('chatScreen').classList.remove('hidden');
            
            // ÎßûÏ∂§ ÌôòÏòÅ Î©îÏãúÏßÄ ÏÉùÏÑ±
            var welcomeMsg = '';
            if (type === 'saessak') {
                welcomeMsg = '<p>ÏïàÎÖïÌïòÏÑ∏Ïöî, ' + nickname + 'Îãò! üå±</p>';
                welcomeMsg += '<p>ÏûÑÏã† Ï§ÄÎπÑ Ï§ëÏù¥ÏãúÍµ∞Ïöî. Ìï®Íªò Í±∏Ïñ¥Í∞àÍ≤åÏöî.</p>';
                welcomeMsg += '<p>Í∂ÅÍ∏àÌïòÍ±∞ÎÇò ÌûòÎì† Í≤å ÏûàÏúºÎ©¥ Ïñ∏Ï†úÎì† ÎßêÏîÄÌï¥ Ï£ºÏÑ∏Ïöî üíö</p>';
            } else if (type === 'yebi') {
                welcomeMsg = '<p>ÏïàÎÖïÌïòÏÑ∏Ïöî, ' + nickname + 'Îãò! ü§∞</p>';
                welcomeMsg += '<p>ÏÜåÏ§ëÌïú ÏÉùÎ™ÖÍ≥º Ìï®ÍªòÌïòÎäî ÏãúÍ∞ÑÏù¥ÎÑ§Ïöî.</p>';
                welcomeMsg += '<p>ÏûÑÏã† Í∏∞Í∞Ñ ÎèôÏïà ÏòÜÏóêÏÑú Ìï®ÍªòÌï†Í≤åÏöî üíï</p>';
            } else if (type === 'agi') {
                welcomeMsg = '<p>ÏïàÎÖïÌïòÏÑ∏Ïöî, ' + nickname + 'Îãò! üë∂</p>';
                welcomeMsg += '<p>Ïú°ÏïÑ, Ï†ïÎßê ÎåÄÎã®ÌïòÏÑ∏Ïöî!</p>';
                welcomeMsg += '<p>ÌûòÎì§ Îïê Ïñ∏Ï†úÎì† Í∏∞ÎåÄÏÑ∏Ïöî üí™</p>';
            }
            
            var messagesDiv = document.querySelector('.chat-messages');
            messagesDiv.innerHTML = '<div class="message bot"><div class="message-avatar">' + icon + '</div><div class="message-content">' + welcomeMsg + '</div></div>';
        }
        
        function selectMate(type) {
            if (type === 'expert') {
                alert('Ï†ÑÎ¨∏Í∞Ä Ïó∞Í≤∞ Í∏∞Îä•ÏùÄ Ï§ÄÎπÑ Ï§ëÏù¥ÏóêÏöî!');
                return;
            }
            startOnboarding(type);
        }
        
        function showIntro() {
            hideAll();
            document.getElementById('introScreen').classList.remove('hidden');
        }
        
        function showLogin() {
            hideAll();
            document.getElementById('loginScreen').classList.remove('hidden');
        }
        
        function showHome() {
            hideAll();
            document.getElementById('homeScreen').classList.remove('hidden');
        }
        
        function showChat(type, icon, name) {
            hideAll();
            document.getElementById('chatMateIcon').textContent = icon;
            document.getElementById('chatMateName').textContent = name;
            document.getElementById('chatScreen').classList.remove('hidden');
            
            // ÌôòÏòÅ Î©îÏãúÏßÄ ÏóÖÎç∞Ïù¥Ìä∏
            var welcomeMsg = document.querySelector('.chat-messages');
            welcomeMsg.innerHTML = `
                <div class="message bot">
                    <div class="message-avatar">${icon}</div>
                    <div class="message-content">
                        <p>ÏïàÎÖïÌïòÏÑ∏Ïöî! ${name}Ïù¥ÏóêÏöî üòä</p>
                        <p>Î¨¥ÏóáÏù¥Îì† Ìé∏ÌïòÍ≤å Î¨ºÏñ¥Î≥¥ÏÑ∏Ïöî.</p>
                    </div>
                </div>
            `;
        }
        
        function showCalendar() {
            hideAll();
            document.getElementById('calendarScreen').classList.remove('hidden');
            generateCalendar();
        }
        
        function showMyPage() {
            hideAll();
            document.getElementById('myScreen').classList.remove('hidden');
        }
        
        function showNotification() {
            hideAll();
            document.getElementById('notificationScreen').classList.remove('hidden');
        }
        
        // ÏÇ¨Ïù¥Îìú Î©îÎâ¥
        function openSideMenu() {
            document.getElementById('sideMenu').classList.remove('hidden');
        }
        
        function closeSideMenu() {
            document.getElementById('sideMenu').classList.add('hidden');
        }
        
        function guestLogin() {
            document.getElementById('userName').textContent = 'Í≤åÏä§Ìä∏Îãò';
            document.getElementById('profileName').textContent = 'Í≤åÏä§Ìä∏Îãò';
            document.getElementById('sideName').textContent = 'Í≤åÏä§Ìä∏Îãò';
            showHome();
        }
        
        function loginWith(provider) {
            alert(provider + ' Î°úÍ∑∏Ïù∏ÏùÄ Ï§ÄÎπÑ Ï§ëÏù¥ÏóêÏöî!');
        }
        
        // Ï∫òÎ¶∞Îçî ÏÉùÏÑ±
        function generateCalendar() {
            var container = document.getElementById('calendarDays');
            var today = new Date();
            var year = today.getFullYear();
            var month = today.getMonth();
            
            var firstDay = new Date(year, month, 1).getDay();
            var lastDate = new Date(year, month + 1, 0).getDate();
            
            var html = '';
            
            // Îπà Ïπ∏
            for (var i = 0; i < firstDay; i++) {
                html += '<div class="calendar-day"></div>';
            }
            
            // ÎÇ†Ïßú
            for (var d = 1; d <= lastDate; d++) {
                var isToday = d === today.getDate() ? 'today' : '';
                var hasEvent = (d === 30 || d === 15) ? 'has-event' : '';
                html += '<div class="calendar-day ' + isToday + ' ' + hasEvent + '">' + d + '</div>';
            }
            
            container.innerHTML = html;
        }
        
        // ==================== RAG API ÏÑ§Ï†ï ====================
        // ÎßòÍ≥Å Ï†ÑÏö© API (Vercel Î∞∞Ìè¨ ÌõÑ ÌôúÏÑ±Ìôî)
        const RAG_API_URL = '/api/search';
        
        // Supabase ÏßÅÏ†ë Ïó∞Í≤∞ (API Î∞∞Ìè¨ Ï†Ñ ÌÖåÏä§Ìä∏Ïö©)
        const SUPABASE_URL = 'https://fzxwqfaddxnhfvnfvnph.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ6eHdxZmFkZHhuaGZ2bmZ2bnBoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzYxNjA1NzAsImV4cCI6MjA1MTczNjU3MH0.eUaJ0S7Qf1jA7PgXPPLNFw8sYQVRqCaRqSJNatMkKyI';
        
        // API Î™®Îìú (true: Vercel API ÏÇ¨Ïö©, false: Supabase ÏßÅÏ†ë Ïó∞Í≤∞)
        const USE_API = true;
        
        // Î©îÏãúÏßÄ Ï†ÑÏÜ°
        async function sendMessage() {
            var input = document.getElementById('chatInput');
            var text = input.value.trim();
            if (!text) return;
            
            var messages = document.getElementById('chatMessages');
            var icon = document.getElementById('chatMateIcon').textContent;
            
            // ÏÇ¨Ïö©Ïûê Î©îÏãúÏßÄ Ï∂îÍ∞Ä
            messages.innerHTML += `
                <div class="message user">
                    <div class="message-content">
                        <p>${escapeHtml(text)}</p>
                    </div>
                </div>
            `;
            
            input.value = '';
            messages.scrollTop = messages.scrollHeight;
            
            // Î°úÎî© ÌëúÏãú
            var loadingId = 'loading-' + Date.now();
            messages.innerHTML += `
                <div class="message bot" id="${loadingId}">
                    <div class="message-avatar">${icon}</div>
                    <div class="message-content">
                        <p class="typing-indicator">ÎãµÎ≥ÄÏùÑ Ï§ÄÎπÑÌïòÍ≥† ÏûàÏñ¥Ïöî<span class="dots">...</span></p>
                    </div>
                </div>
            `;
            messages.scrollTop = messages.scrollHeight;
            
            try {
                // RAG API Ìò∏Ï∂ú
                var response = await fetchRAGResponse(text);
                
                // Î°úÎî© Ï†úÍ±∞
                var loadingEl = document.getElementById(loadingId);
                if (loadingEl) loadingEl.remove();
                
                // AI ÏùëÎãµ ÌëúÏãú
                if (response && response.content) {
                    messages.innerHTML += formatBotMessage(icon, response);
                } else {
                    messages.innerHTML += `
                        <div class="message bot">
                            <div class="message-avatar">${icon}</div>
                            <div class="message-content">
                                <p>Ï£ÑÏÜ°Ìï¥Ïöî, Í¥ÄÎ†® Ï†ïÎ≥¥Î•º Ï∞æÏßÄ Î™ªÌñàÏñ¥Ïöî. üò¢</p>
                                <p>Îã§Î•∏ Î∞©ÏãùÏúºÎ°ú ÏßàÎ¨∏Ìï¥ Ï£ºÏãúÍ±∞ÎÇò, Ï†ÑÎ¨∏Í∞Ä ÏÉÅÎã¥ÏùÑ Ïù¥Ïö©Ìï¥ Î≥¥ÏÑ∏Ïöî!</p>
                            </div>
                        </div>
                    `;
                }
            } catch (error) {
                console.error('RAG API Error:', error);
                var loadingEl = document.getElementById(loadingId);
                if (loadingEl) loadingEl.remove();
                
                messages.innerHTML += `
                    <div class="message bot">
                        <div class="message-avatar">${icon}</div>
                        <div class="message-content">
                            <p>ÎÑ§Ìä∏ÏõåÌÅ¨ Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏñ¥Ïöî. Ïû†Ïãú ÌõÑ Îã§Ïãú ÏãúÎèÑÌï¥ Ï£ºÏÑ∏Ïöî. üôè</p>
                        </div>
                    </div>
                `;
            }
            
            messages.scrollTop = messages.scrollHeight;
        }
        
        // RAG API Ìò∏Ï∂ú Ìï®Ïàò
        async function fetchRAGResponse(query) {
            try {
                if (USE_API) {
                    // Vercel API ÏÇ¨Ïö©
                    var response = await fetch('/api/chat', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ 
                            query: query,
                            mateType: currentOnboarding.type || 'default',
                            userInfo: {
                                nickname: currentOnboarding.answers?.[currentOnboarding.answers.length - 1],
                                answers: currentOnboarding.answers
                            }
                        })
                    });
                    
                    if (!response.ok) throw new Error('API response not ok');
                    
                    var data = await response.json();
                    return {
                        title: '',
                        content: data.answer,
                        related: data.related || []
                    };
                } else {
                    // Supabase ÏßÅÏ†ë Ïó∞Í≤∞
                    return await searchSupabaseDirect(query);
                }
            } catch (error) {
                console.error('Fetch error:', error);
                return fallbackSearch(query);
            }
        }
        
        // Supabase ÏßÅÏ†ë Í≤ÄÏÉâ (API Î∞∞Ìè¨ Ï†Ñ ÌÖåÏä§Ìä∏Ïö©)
        async function searchSupabaseDirect(query) {
            const searchTerm = query.trim().toLowerCase();
            
            // ÌÇ§ÏõåÎìú Îß§Ìïë
            const keywordMap = {
                'Ï†ñÎ™∏ÏÇ¥': ['Ï†ñÎ™∏ÏÇ¥', 'Ïö∏Ìòà', 'Ïú†Î∞©Ïö∏Ìòà', 'ÌÜµÏ¶ù'],
                'Ïú†ÏÑ†Ïóº': ['Ïú†ÏÑ†Ïóº', 'Ïó¥', 'Í∞êÏóº', 'Ìï≠ÏÉùÏ†ú'],
                'Ï†ñÏñë': ['Ï†ñÏñë', 'Î™®Ïú†Îüâ', 'Î∂ÄÏ°±', 'ÎäòÎ¶¨Í∏∞'],
                'Î∞§ÏàòÏú†': ['Î∞§ÏàòÏú†', 'ÏïºÍ∞ÑÏàòÏú†', 'ÏàòÎ©¥'],
                'Ïù¥Ïú†Ïãù': ['Ïù¥Ïú†Ïãù', 'Í≥†ÌòïÏãù', 'ÏãúÏûë'],
                'Î≥µÏßÅ': ['Î≥µÏßÅ', 'ÏßÅÏû•', 'Ïú†Ï∂ï', 'ÏõåÌÇπÎßò'],
                'ÏûÖÎçß': ['ÏûÖÎçß', 'Ïò§Ïã¨', 'Íµ¨ÌÜ†'],
                'ÌÉúÍµê': ['ÌÉúÍµê', 'ÌÉúÎã¥'],
                'ÏÇ∞ÌõÑÏö∞Ïö∏': ['ÏÇ∞ÌõÑÏö∞Ïö∏', 'Ïö∞Ïö∏Ï¶ù'],
                'Ìô©Îã¨': ['Ìô©Îã¨', 'Ïã†ÏÉùÏïÑ'],
                'Ïú†Îëê': ['Ïú†Îëê', 'Í∑†Ïó¥', 'ÏÉÅÏ≤ò', 'ÌÜµÏ¶ù'],
                'ÏûêÏÑ∏': ['ÏûêÏÑ∏', 'ÎûòÏπò', 'Î¨ºÎ¶º']
            };
            
            let expandedKeywords = [searchTerm];
            for (const [key, values] of Object.entries(keywordMap)) {
                if (searchTerm.includes(key)) {
                    expandedKeywords = [...expandedKeywords, ...values];
                }
            }
            
            try {
                const response = await fetch(`${SUPABASE_URL}/rest/v1/knowledge_units?select=*`, {
                    headers: {
                        'Content-Type': 'application/json',
                        'apikey': SUPABASE_ANON_KEY,
                        'Authorization': `Bearer ${SUPABASE_ANON_KEY}`
                    }
                });
                
                if (!response.ok) throw new Error('Supabase error');
                
                let results = await response.json();
                
                // Ï†êÏàò Í≥ÑÏÇ∞
                results = results.map(item => {
                    let score = 0;
                    const title = (item.title || '').toLowerCase();
                    const content = (item.content || '').toLowerCase();
                    const keywords = Array.isArray(item.keywords) ? item.keywords.join(' ').toLowerCase() : '';
                    
                    for (const kw of expandedKeywords) {
                        if (title.includes(kw)) score += 10;
                        if (content.includes(kw)) score += 5;
                        if (keywords.includes(kw)) score += 8;
                    }
                    
                    if (item.urgency === 'Ï¶âÏãúÎåÄÏùëÌïÑÏöî') score += 3;
                    
                    return { ...item, score };
                });
                
                // ÌïÑÌÑ∞ÎßÅ Î∞è Ï†ïÎ†¨
                results = results
                    .filter(item => item.score > 0 && item.content && item.content.length >= 50)
                    .sort((a, b) => b.score - a.score);
                
                if (results.length > 0) {
                    const top = results[0];
                    return {
                        title: top.title || '',
                        content: top.content || '',
                        related: results.slice(1, 4).map(r => r.title)
                    };
                }
                
                return null;
            } catch (error) {
                console.error('Supabase direct search error:', error);
                return null;
            }
        }
        
        // Ìè¥Î∞± Í≤ÄÏÉâ (RAG Ïã§Ìå® Ïãú Î°úÏª¨ ÌÇ§ÏõåÎìú Îß§Ïπ≠)
        function fallbackSearch(query) {
            var keywords = {
                'Ï†ñÎ™∏ÏÇ¥': { title: 'Ï†ñÎ™∏ÏÇ¥ ÎåÄÏ≤òÎ≤ï', content: 'Ï†ñÎ™∏ÏÇ¥ÏùÄ ÏàòÏú† Ï¥àÍ∏∞Ïóê ÌùîÌûà Í≤™Îäî Ï¶ùÏÉÅÏù¥ÏóêÏöî. ÏûêÏ£º ÏàòÏú†ÌïòÍ≥†, Îî∞ÎúªÌïú Ï∞úÏßà ÌõÑ ÏàòÏú†ÌïòÎ©¥ ÎèÑÏõÄÏù¥ Îê©ÎãàÎã§. Ïã¨Ìïú Í≤ΩÏö∞ Ï†ÑÎ¨∏Í∞Ä ÏÉÅÎã¥ÏùÑ Í∂åÌï¥Ïöî.' },
                'Î™®Ïú†': { title: 'Î™®Ïú†ÏàòÏú† Í∏∞Î≥∏ Í∞ÄÏù¥Îìú', content: 'Î™®Ïú†ÏàòÏú†Îäî ÏïÑÍ∏∞ÏôÄ ÏóÑÎßà Î™®ÎëêÏóêÍ≤å Ï¢ãÏïÑÏöî. Ïò¨Î∞îÎ•∏ Ï†ñÎ¨ºÎ¶ºÍ≥º Ìé∏ÏïàÌïú ÏûêÏÑ∏Í∞Ä Ï§ëÏöîÌï©ÎãàÎã§.' },
                'Î∞§ÏàòÏú†': { title: 'Î∞§ÏàòÏú† Ï§ÑÏù¥Í∏∞', content: 'ÏïÑÍ∏∞Í∞Ä 4-6Í∞úÏõîÏù¥ ÎêòÎ©¥ Î∞§ÏàòÏú†Î•º Ï†êÏ∞® Ï§ÑÏùº Ïàò ÏûàÏñ¥Ïöî. ÎÇÆ ÎèôÏïà Ï∂©Î∂ÑÌûà Î®πÏù¥Í≥†, Ï∑®Ïπ® Î£®Ìã¥ÏùÑ ÎßåÎì§Ïñ¥ Î≥¥ÏÑ∏Ïöî.' },
                'Ïù¥Ïú†Ïãù': { title: 'Ïù¥Ïú†Ïãù ÏãúÏûëÌïòÍ∏∞', content: 'Ïù¥Ïú†ÏãùÏùÄ Î≥¥ÌÜµ Îßå 6Í∞úÏõî Ï†ÑÌõÑÏóê ÏãúÏûëÌï¥Ïöî. ÏåÄ ÎØ∏ÏùåÎ∂ÄÌÑ∞ ÏãúÏûëÌï¥ÏÑú Ï†êÏ∞® Îã§ÏñëÌïú ÏãùÏû¨Î£åÎ•º ÏãúÎèÑÌï¥ Î≥¥ÏÑ∏Ïöî.' },
                'Î≥µÏßÅ': { title: 'Î≥µÏßÅ Ï§ÄÎπÑÌïòÍ∏∞', content: 'Î≥µÏßÅ 2-4Ï£º Ï†ÑÎ∂ÄÌÑ∞ Ïú†Ï∂ïÍ∏∞ ÏÇ¨Ïö©ÏùÑ Ïó∞ÏäµÌïòÍ≥†, Î™®Ïú† Ï†ÄÏû•ÏùÑ ÏãúÏûëÌïòÏÑ∏Ïöî. ÏßÅÏû• ÎÇ¥ ÏàòÏú†Ïã§ ÏúÑÏπòÎèÑ ÎØ∏Î¶¨ ÌôïÏù∏Ìï¥ ÎëêÏÑ∏Ïöî.' }
            };
            
            for (var key in keywords) {
                if (query.includes(key)) {
                    return keywords[key];
                }
            }
            
            return null;
        }
        
        // Î¥á Î©îÏãúÏßÄ Ìè¨Îß∑ÌåÖ
        function formatBotMessage(icon, response) {
            var content = response.content || '';
            var title = response.title || '';
            var relatedTopics = response.related || [];
            
            var html = `
                <div class="message bot">
                    <div class="message-avatar">${icon}</div>
                    <div class="message-content">
            `;
            
            if (title) {
                html += `<p class="answer-title"><strong>${escapeHtml(title)}</strong></p>`;
            }
            
            // ÎÇ¥Ïö©ÏùÑ Î¨∏Îã®ÏúºÎ°ú Î∂ÑÎ¶¨
            var paragraphs = content.split('\n').filter(function(p) { return p.trim(); });
            paragraphs.forEach(function(p) {
                html += `<p>${escapeHtml(p)}</p>`;
            });
            
            // Í¥ÄÎ†® Ï£ºÏ†ú
            if (relatedTopics.length > 0) {
                html += `<div class="related-topics">`;
                html += `<p class="related-label">Í¥ÄÎ†® Ï†ïÎ≥¥:</p>`;
                relatedTopics.forEach(function(topic) {
                    html += `<button class="related-btn" onclick="searchRelated('${escapeHtml(topic)}')">${escapeHtml(topic)}</button>`;
                });
                html += `</div>`;
            }
            
            html += `
                    </div>
                </div>
            `;
            
            return html;
        }
        
        // Í¥ÄÎ†® Ï£ºÏ†ú Í≤ÄÏÉâ
        function searchRelated(topic) {
            document.getElementById('chatInput').value = topic;
            sendMessage();
        }
        
        // HTML Ïù¥Ïä§ÏºÄÏù¥ÌîÑ
        function escapeHtml(text) {
            var div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }
        
        // ==================== ÏùåÏÑ± Ïù∏Ïãù ====================
        var recognition = null;
        var isRecording = false;
        
        function initSpeechRecognition() {
            if ('webkitSpeechRecognition' in window || 'SpeechRecognition' in window) {
                var SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
                recognition = new SpeechRecognition();
                recognition.lang = 'ko-KR';
                recognition.continuous = false;
                recognition.interimResults = true;
                
                recognition.onstart = function() {
                    isRecording = true;
                    document.getElementById('micBtn').classList.add('recording');
                    document.getElementById('recordingIndicator').classList.add('active');
                    document.getElementById('chatInput').placeholder = 'ÎßêÏîÄÌïòÏÑ∏Ïöî...';
                };
                
                recognition.onresult = function(event) {
                    var finalTranscript = '';
                    var interimTranscript = '';
                    
                    for (var i = event.resultIndex; i < event.results.length; i++) {
                        var transcript = event.results[i][0].transcript;
                        if (event.results[i].isFinal) {
                            finalTranscript += transcript;
                        } else {
                            interimTranscript += transcript;
                        }
                    }
                    
                    // ÏûÖÎ†•Ï∞ΩÏóê Ïã§ÏãúÍ∞Ñ ÌëúÏãú
                    document.getElementById('chatInput').value = finalTranscript || interimTranscript;
                };
                
                recognition.onend = function() {
                    isRecording = false;
                    document.getElementById('micBtn').classList.remove('recording');
                    document.getElementById('recordingIndicator').classList.remove('active');
                    document.getElementById('chatInput').placeholder = 'Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî...';
                    document.getElementById('chatInput').focus();
                    
                    // ÌÖçÏä§Ìä∏Í∞Ä ÏûàÏúºÎ©¥ ÏûêÎèô Ï†ÑÏÜ° (ÏÑ†ÌÉùÏÇ¨Ìï≠)
                    // var text = document.getElementById('chatInput').value.trim();
                    // if (text) sendMessage();
                };
                
                recognition.onerror = function(event) {
                    console.error('Speech recognition error:', event.error);
                    isRecording = false;
                    document.getElementById('micBtn').classList.remove('recording');
                    document.getElementById('recordingIndicator').classList.remove('active');
                    document.getElementById('chatInput').placeholder = 'Î©îÏãúÏßÄÎ•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî...';
                    
                    var message = 'Îã§Ïãú ÏãúÎèÑÌï¥Ï£ºÏÑ∏Ïöî';
                    if (event.error === 'not-allowed') {
                        message = 'ÎßàÏù¥ÌÅ¨ Í∂åÌïúÏùÑ ÌóàÏö©Ìï¥Ï£ºÏÑ∏Ïöî';
                    } else if (event.error === 'no-speech') {
                        message = 'ÏùåÏÑ±Ïù¥ Í∞êÏßÄÎêòÏßÄ ÏïäÏïòÏñ¥Ïöî';
                    } else if (event.error === 'audio-capture') {
                        message = 'ÎßàÏù¥ÌÅ¨Î•º ÌôïÏù∏Ìï¥Ï£ºÏÑ∏Ïöî';
                    }
                    alert(message);
                };
                
                return true;
            }
            return false;
        }
        
        function toggleRecording() {
            if (!recognition) {
                if (!initSpeechRecognition()) {
                    alert('Ïù¥ Î∏åÎùºÏö∞Ï†ÄÏóêÏÑúÎäî ÏùåÏÑ± ÏûÖÎ†•ÏùÑ ÏßÄÏõêÌïòÏßÄ ÏïäÏïÑÏöî');
                    return;
                }
            }
            
            if (isRecording) {
                recognition.stop();
            } else {
                try {
                    recognition.start();
                } catch (e) {
                    recognition.stop();
                    setTimeout(function() {
                        recognition.start();
                    }, 100);
                }
            }
        }
        
        // Ïù¥Î≤§Ìä∏ Î¶¨Ïä§ÎÑà Îì±Î°ù (DOM Î°úÎìú ÌõÑ)
        document.addEventListener('DOMContentLoaded', function() {
            // Ïù∏Ìä∏Î°ú ‚Üí Î°úÍ∑∏Ïù∏
            document.querySelector('.intro-btn').addEventListener('click', showLogin);
            
            // Î°úÍ∑∏Ïù∏ ÌôîÎ©¥ Îí§Î°úÍ∞ÄÍ∏∞
            document.querySelector('.login-screen .back-btn').addEventListener('click', showIntro);
            
            // Í≤åÏä§Ìä∏ Î°úÍ∑∏Ïù∏
            document.querySelector('.login-btn-guest').addEventListener('click', guestLogin);
            
            // ÏÜåÏÖú Î°úÍ∑∏Ïù∏
            document.querySelector('.login-btn-kakao').addEventListener('click', function() { loginWith('Ïπ¥Ïπ¥Ïò§'); });
            document.querySelector('.login-btn-google').addEventListener('click', function() { loginWith('Google'); });
            document.querySelector('.login-btn-apple').addEventListener('click', function() { loginWith('Apple'); });
            
            // ÎßòÍ≥Å Ïπ¥ÎìúÎì§ - Ïò®Î≥¥Îî©ÏúºÎ°ú Ïó∞Í≤∞
            document.getElementById('cardSaessak').addEventListener('click', function() {
                selectMate('saessak');
            });
            document.getElementById('cardYebi').addEventListener('click', function() {
                selectMate('yebi');
            });
            document.getElementById('cardAgi').addEventListener('click', function() {
                selectMate('agi');
            });
            document.getElementById('cardExpert').addEventListener('click', function() {
                selectMate('expert');
            });
            
            // Ïò®Î≥¥Îî© Îí§Î°úÍ∞ÄÍ∏∞
            document.getElementById('onboardingBackBtn').addEventListener('click', function() {
                if (currentOnboarding.step > 0) {
                    currentOnboarding.step--;
                    currentOnboarding.answers.pop();
                    renderOnboardingStep();
                } else {
                    showHome();
                }
            });
            
            // Ï±ÑÌåÖ Îí§Î°úÍ∞ÄÍ∏∞
            document.getElementById('chatBackBtn').addEventListener('click', showHome);
            
            // Î©îÏãúÏßÄ Ï†ÑÏÜ°
            document.getElementById('sendBtn').addEventListener('click', sendMessage);
            document.getElementById('chatInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') sendMessage();
            });
            
            // ÎßàÏù¥ÌÅ¨ Î≤ÑÌäº (ÏùåÏÑ± Ïù∏Ïãù)
            document.getElementById('micBtn').addEventListener('click', toggleRecording);
            
            // ===== Ìôà ÌôîÎ©¥ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò =====
            document.getElementById('navHome').addEventListener('click', showHome);
            document.getElementById('navCalendar').addEventListener('click', showCalendar);
            document.getElementById('navChat').addEventListener('click', function() {
                showChat('default', 'ü§±', 'ÎßòÍ≥Å');
            });
            document.getElementById('navMy').addEventListener('click', showMyPage);
            
            // Ìôà Ìó§Îçî ÏïÑÏù¥ÏΩò (ÌñÑÎ≤ÑÍ±∞, ÏïåÎ¶º)
            document.getElementById('homeMenuBtn').addEventListener('click', openSideMenu);
            document.getElementById('homeNotiBtn').addEventListener('click', showNotification);
            
            // ===== Ï∫òÎ¶∞Îçî ÌôîÎ©¥ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò =====
            document.getElementById('calNavHome').addEventListener('click', showHome);
            document.getElementById('calNavCalendar').addEventListener('click', showCalendar);
            document.getElementById('calNavChat').addEventListener('click', function() {
                showChat('default', 'ü§±', 'ÎßòÍ≥Å');
            });
            document.getElementById('calNavMy').addEventListener('click', showMyPage);
            document.getElementById('calMenuBtn').addEventListener('click', openSideMenu);
            document.getElementById('calNotiBtn').addEventListener('click', showNotification);
            
            // ===== ÎßàÏù¥ÌéòÏù¥ÏßÄ ÎÑ§ÎπÑÍ≤åÏù¥ÏÖò =====
            document.getElementById('myNavHome').addEventListener('click', showHome);
            document.getElementById('myNavCalendar').addEventListener('click', showCalendar);
            document.getElementById('myNavChat').addEventListener('click', function() {
                showChat('default', 'ü§±', 'ÎßòÍ≥Å');
            });
            document.getElementById('myNavMy').addEventListener('click', showMyPage);
            document.getElementById('myMenuBtn').addEventListener('click', openSideMenu);
            document.getElementById('myNotiBtn').addEventListener('click', showNotification);
            
            // ===== ÏïåÎ¶º ÌôîÎ©¥ Îí§Î°úÍ∞ÄÍ∏∞ =====
            document.getElementById('notiBackBtn').addEventListener('click', showHome);
            
            // ===== ÏÇ¨Ïù¥Îìú Î©îÎâ¥ =====
            document.getElementById('closeMenuBtn').addEventListener('click', closeSideMenu);
            document.getElementById('sideMenuOverlay').addEventListener('click', closeSideMenu);
            
            document.getElementById('sideHome').addEventListener('click', showHome);
            document.getElementById('sideSaessak').addEventListener('click', function() {
                showChat('saessak', 'üå±', 'ÏòàÎπÑÎßòÍ≥Å');
            });
            document.getElementById('sideYebi').addEventListener('click', function() {
                showChat('yebi', 'ü§∞', 'ÏûÑÏã†ÎßòÍ≥Å');
            });
            document.getElementById('sideAgi').addEventListener('click', function() {
                showChat('agi', 'üë∂', 'Ï¥àÎ≥¥ÎßòÍ≥Å');
            });
            document.getElementById('sideExpert').addEventListener('click', function() {
                showChat('expert', 'üë©‚Äç‚öïÔ∏è', 'Ï†ÑÎ¨∏Í∞Ä Ïó∞Í≤∞');
            });
            document.getElementById('sideCalendar').addEventListener('click', showCalendar);
            document.getElementById('sideSettings').addEventListener('click', function() {
                alert('ÏÑ§Ï†ï ÌôîÎ©¥ÏùÄ Ï§ÄÎπÑ Ï§ëÏù¥ÏóêÏöî!');
            });
            document.getElementById('sideLogout').addEventListener('click', function() {
                if (confirm('Î°úÍ∑∏ÏïÑÏõÉ ÌïòÏãúÍ≤†Ïñ¥Ïöî?')) {
                    showIntro();
                }
            });
        });
    </script>
</body>
</html>
