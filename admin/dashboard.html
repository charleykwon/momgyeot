<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë§˜ê³ ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        :root {
            --olive: #5E6B3A;
            --olive-light: #8A9A5B;
            --olive-bg: #F0F2E8;
            --pink: #E8B4B8;
            --pink-light: #F5D6D9;
            --black-olive: #3D4A2D;
            --warm-gray: #6B6B6B;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Noto Sans KR', sans-serif;
            background: #F5F7F0;
            min-height: 100vh;
        }
        
        /* í—¤ë” */
        .header {
            background: white;
            padding: 16px 32px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
        }
        
        .header-left {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .header-logo { font-size: 28px; }
        
        .header-title {
            font-size: 18px;
            font-weight: 700;
            color: var(--black-olive);
        }
        
        .header-right {
            display: flex;
            align-items: center;
            gap: 16px;
        }
        
        .user-info {
            font-size: 14px;
            color: var(--warm-gray);
        }
        
        .logout-btn {
            padding: 8px 16px;
            background: transparent;
            border: 1.5px solid var(--olive);
            color: var(--olive);
            border-radius: 8px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .logout-btn:hover {
            background: var(--olive);
            color: white;
        }
        
        /* ë©”ì¸ ì»¨í…ì¸  */
        .main {
            padding: 32px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .page-title {
            font-size: 24px;
            font-weight: 700;
            color: var(--black-olive);
            margin-bottom: 8px;
        }
        
        .page-subtitle {
            font-size: 14px;
            color: var(--warm-gray);
            margin-bottom: 32px;
        }
        
        /* í†µê³„ ì¹´ë“œ */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .stat-card {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        
        .stat-card.highlight {
            background: linear-gradient(135deg, var(--olive) 0%, var(--olive-light) 100%);
            color: white;
        }
        
        .stat-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }
        
        .stat-value {
            font-size: 32px;
            font-weight: 700;
            margin-bottom: 4px;
        }
        
        .stat-label {
            font-size: 14px;
            opacity: 0.8;
        }
        
        .stat-change {
            font-size: 12px;
            margin-top: 8px;
            display: flex;
            align-items: center;
            gap: 4px;
        }
        
        .stat-change.up { color: #4CAF50; }
        .stat-change.down { color: #F44336; }
        .stat-card.highlight .stat-change { color: rgba(255,255,255,0.9); }
        
        /* ì°¨íŠ¸ ì„¹ì…˜ */
        .charts-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .chart-card {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        
        .chart-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--black-olive);
            margin-bottom: 20px;
        }
        
        .chart-container {
            height: 280px;
            position: relative;
        }
        
        /* í–‰ë™ ë¶„ì„ */
        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 20px;
            margin-bottom: 32px;
        }
        
        .analysis-card {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        
        .analysis-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--black-olive);
            margin-bottom: 16px;
        }
        
        .time-bars {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .time-bar {
            display: flex;
            align-items: center;
            gap: 12px;
        }
        
        .time-label {
            width: 60px;
            font-size: 12px;
            color: var(--warm-gray);
        }
        
        .time-progress {
            flex: 1;
            height: 8px;
            background: #E8E8E8;
            border-radius: 4px;
            overflow: hidden;
        }
        
        .time-fill {
            height: 100%;
            background: var(--olive);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .time-value {
            width: 40px;
            font-size: 12px;
            font-weight: 600;
            color: var(--black-olive);
            text-align: right;
        }
        
        /* ì‚¬ìš©ì ìœ í˜• */
        .user-types {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .user-type {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--olive-bg);
            border-radius: 10px;
        }
        
        .type-icon { font-size: 24px; }
        
        .type-info { flex: 1; }
        
        .type-name {
            font-size: 13px;
            font-weight: 500;
            color: var(--black-olive);
        }
        
        .type-count {
            font-size: 11px;
            color: var(--warm-gray);
        }
        
        .type-percent {
            font-size: 16px;
            font-weight: 700;
            color: var(--olive);
        }
        
        /* í•« í‚¤ì›Œë“œ */
        .keywords {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }
        
        .keyword {
            padding: 8px 14px;
            background: var(--olive-bg);
            border-radius: 20px;
            font-size: 13px;
            color: var(--black-olive);
        }
        
        .keyword.hot {
            background: var(--pink-light);
            color: #8B4557;
        }
        
        /* ìµœê·¼ ëŒ€í™” í…Œì´ë¸” */
        .table-card {
            background: white;
            padding: 24px;
            border-radius: 16px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        }
        
        .table-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .table-title {
            font-size: 16px;
            font-weight: 600;
            color: var(--black-olive);
        }
        
        .search-box {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: #F5F5F5;
            border-radius: 8px;
        }
        
        .search-box input {
            border: none;
            background: transparent;
            font-size: 14px;
            font-family: inherit;
            width: 200px;
        }
        
        .search-box input:focus { outline: none; }
        
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 14px 16px;
            text-align: left;
            border-bottom: 1px solid #F0F0F0;
        }
        
        th {
            font-size: 12px;
            font-weight: 600;
            color: var(--warm-gray);
            text-transform: uppercase;
        }
        
        td {
            font-size: 14px;
            color: var(--black-olive);
        }
        
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }
        
        .badge-saessak { background: #E8F5E9; color: #388E3C; }
        .badge-yebi { background: #FFF3E0; color: #F57C00; }
        .badge-agi { background: #E3F2FD; color: #1976D2; }
        
        /* ë°˜ì‘í˜• */
        @media (max-width: 1200px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
            .charts-grid { grid-template-columns: 1fr; }
            .analysis-grid { grid-template-columns: 1fr; }
        }
        
        @media (max-width: 768px) {
            .main { padding: 16px; }
            .stats-grid { grid-template-columns: 1fr; }
            .header { padding: 12px 16px; }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-left">
            <span class="header-logo">ğŸ¤±</span>
            <span class="header-title">ë§˜ê³ ê´€ë¦¬ì</span>
        </div>
        <div class="header-right">
            <span class="user-info" id="userInfo">ê´€ë¦¬ìë‹˜</span>
            <button class="logout-btn" onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>
        </div>
    </header>
    
    <main class="main">
        <h1 class="page-title">ëŒ€ì‹œë³´ë“œ</h1>
        <p class="page-subtitle">ë§˜ê³ ì„œë¹„ìŠ¤ í˜„í™©ì„ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p>
        
        <!-- í†µê³„ ì¹´ë“œ -->
        <div class="stats-grid">
            <div class="stat-card highlight">
                <div class="stat-icon">ğŸ‘¥</div>
                <div class="stat-value" id="totalUsers">1,247</div>
                <div class="stat-label">ì´ ì‚¬ìš©ì</div>
                <div class="stat-change up">â†‘ 12% ì§€ë‚œì£¼ ëŒ€ë¹„</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ“Š</div>
                <div class="stat-value" id="dau">328</div>
                <div class="stat-label">ì˜¤ëŠ˜ í™œì„± ì‚¬ìš©ì (DAU)</div>
                <div class="stat-change up">â†‘ 8% ì–´ì œ ëŒ€ë¹„</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">ğŸ’¬</div>
                <div class="stat-value" id="totalChats">5,832</div>
                <div class="stat-label">ì´ ëŒ€í™” ìˆ˜</div>
                <div class="stat-change up">â†‘ 23% ì§€ë‚œì£¼ ëŒ€ë¹„</div>
            </div>
            <div class="stat-card">
                <div class="stat-icon">â±ï¸</div>
                <div class="stat-value" id="avgSession">4.2ë¶„</div>
                <div class="stat-label">í‰ê·  ì„¸ì…˜ ì‹œê°„</div>
                <div class="stat-change down">â†“ 5% ì§€ë‚œì£¼ ëŒ€ë¹„</div>
            </div>
        </div>
        
        <!-- ì°¨íŠ¸ -->
        <div class="charts-grid">
            <div class="chart-card">
                <h3 class="chart-title">ğŸ“ˆ ì¼ë³„ í™œë™ ì¶”ì´</h3>
                <div class="chart-container">
                    <canvas id="dailyChart"></canvas>
                </div>
            </div>
            <div class="chart-card">
                <h3 class="chart-title">ğŸ¯ ì¸ê¸° ì£¼ì œ</h3>
                <div class="chart-container">
                    <canvas id="topicsChart"></canvas>
                </div>
            </div>
        </div>
        
        <!-- í–‰ë™ ë¶„ì„ -->
        <div class="analysis-grid">
            <div class="analysis-card">
                <h4 class="analysis-title">â° ì‹œê°„ëŒ€ë³„ ì´ìš© íŒ¨í„´</h4>
                <div class="time-bars">
                    <div class="time-bar">
                        <span class="time-label">ìƒˆë²½</span>
                        <div class="time-progress"><div class="time-fill" style="width: 25%"></div></div>
                        <span class="time-value">25%</span>
                    </div>
                    <div class="time-bar">
                        <span class="time-label">ì˜¤ì „</span>
                        <div class="time-progress"><div class="time-fill" style="width: 45%"></div></div>
                        <span class="time-value">45%</span>
                    </div>
                    <div class="time-bar">
                        <span class="time-label">ì˜¤í›„</span>
                        <div class="time-progress"><div class="time-fill" style="width: 60%"></div></div>
                        <span class="time-value">60%</span>
                    </div>
                    <div class="time-bar">
                        <span class="time-label">ì €ë…</span>
                        <div class="time-progress"><div class="time-fill" style="width: 80%"></div></div>
                        <span class="time-value">80%</span>
                    </div>
                </div>
            </div>
            
            <div class="analysis-card">
                <h4 class="analysis-title">ğŸ‘¤ ì‚¬ìš©ì ìœ í˜• ë¶„í¬</h4>
                <div class="user-types">
                    <div class="user-type">
                        <span class="type-icon">ğŸŒ±</span>
                        <div class="type-info">
                            <div class="type-name">ì˜ˆë¹„ë§˜</div>
                            <div class="type-count">312ëª…</div>
                        </div>
                        <span class="type-percent">25%</span>
                    </div>
                    <div class="user-type">
                        <span class="type-icon">ğŸ¤°</span>
                        <div class="type-info">
                            <div class="type-name">ì„ì‹ ë§˜</div>
                            <div class="type-count">498ëª…</div>
                        </div>
                        <span class="type-percent">40%</span>
                    </div>
                    <div class="user-type">
                        <span class="type-icon">ğŸ‘¶</span>
                        <div class="type-info">
                            <div class="type-name">ì´ˆë³´ë§˜</div>
                            <div class="type-count">437ëª…</div>
                        </div>
                        <span class="type-percent">35%</span>
                    </div>
                </div>
            </div>
            
            <div class="analysis-card">
                <h4 class="analysis-title">ğŸ”¥ í•« í‚¤ì›Œë“œ TOP 5</h4>
                <div class="keywords">
                    <span class="keyword hot">ëª¨ìœ ìˆ˜ìœ </span>
                    <span class="keyword hot">ì –ëª¸ì‚´</span>
                    <span class="keyword">ë°¤ìˆ˜ìœ </span>
                    <span class="keyword">ì´ìœ ì‹</span>
                    <span class="keyword">ë³µì§</span>
                </div>
            </div>
        </div>
        
        <!-- ìµœê·¼ ëŒ€í™” -->
        <div class="table-card">
            <div class="table-header">
                <h3 class="table-title">ğŸ’¬ ìµœê·¼ ëŒ€í™”</h3>
                <div class="search-box">
                    <span>ğŸ”</span>
                    <input type="text" placeholder="ê²€ìƒ‰..." id="searchInput" onkeyup="filterTable()">
                </div>
            </div>
            <table id="conversationsTable">
                <thead>
                    <tr>
                        <th>ì‹œê°„</th>
                        <th>ì‚¬ìš©ì</th>
                        <th>ìœ í˜•</th>
                        <th>ì§ˆë¬¸</th>
                        <th>ìƒíƒœ</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>10:32</td>
                        <td>ì½©ì´ë§˜</td>
                        <td><span class="badge badge-agi">ì´ˆë³´ë§˜</span></td>
                        <td>ì –ëª¸ì‚´ì´ ì‹¬í•œë° ì–´ë–»ê²Œ í•´ì•¼ í•˜ë‚˜ìš”?</td>
                        <td>âœ… ì‘ë‹µì™„ë£Œ</td>
                    </tr>
                    <tr>
                        <td>10:28</td>
                        <td>í•˜ëŠ˜ë§˜</td>
                        <td><span class="badge badge-yebi">ì„ì‹ ë§˜</span></td>
                        <td>ì„ì‹  12ì£¼ì°¨ì¸ë° ì…ë§ì´ ë„ˆë¬´ ì‹¬í•´ìš”</td>
                        <td>âœ… ì‘ë‹µì™„ë£Œ</td>
                    </tr>
                    <tr>
                        <td>10:15</td>
                        <td>ë³´ë¯¸</td>
                        <td><span class="badge badge-saessak">ì˜ˆë¹„ë§˜</span></td>
                        <td>ì„ì‹  ì¤€ë¹„ ì¤‘ì¸ë° ì—½ì‚°ì€ ì–¸ì œë¶€í„° ë¨¹ë‚˜ìš”?</td>
                        <td>âœ… ì‘ë‹µì™„ë£Œ</td>
                    </tr>
                    <tr>
                        <td>09:58</td>
                        <td>ë³„ì´ë§˜</td>
                        <td><span class="badge badge-agi">ì´ˆë³´ë§˜</span></td>
                        <td>100ì¼ ì•„ê¸° ë°¤ìˆ˜ìœ  ì¤„ì´ëŠ” ë°©ë²•</td>
                        <td>âœ… ì‘ë‹µì™„ë£Œ</td>
                    </tr>
                    <tr>
                        <td>09:45</td>
                        <td>ë‹¬ì½©ë§˜</td>
                        <td><span class="badge badge-agi">ì´ˆë³´ë§˜</span></td>
                        <td>ëª¨ìœ  ë³´ê´€ ë°©ë²•ì´ ê¶ê¸ˆí•´ìš”</td>
                        <td>âœ… ì‘ë‹µì™„ë£Œ</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </main>
    
    <script>
        // ì„¸ì…˜ ì²´í¬
        function checkAuth() {
            const session = localStorage.getItem('momgyeot_admin_session');
            if (!session) {
                window.location.href = 'login.html';
                return;
            }
            const { username, expiry } = JSON.parse(session);
            if (new Date().getTime() > expiry) {
                localStorage.removeItem('momgyeot_admin_session');
                window.location.href = 'login.html';
                return;
            }
            document.getElementById('userInfo').textContent = username + 'ë‹˜';
        }
        
        function logout() {
            localStorage.removeItem('momgyeot_admin_session');
            window.location.href = 'login.html';
        }
        
        // í…Œì´ë¸” ê²€ìƒ‰
        function filterTable() {
            const input = document.getElementById('searchInput').value.toLowerCase();
            const rows = document.querySelectorAll('#conversationsTable tbody tr');
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(input) ? '' : 'none';
            });
        }
        
        // ì°¨íŠ¸ ì´ˆê¸°í™”
        function initCharts() {
            // ì¼ë³„ í™œë™ ì°¨íŠ¸
            const dailyCtx = document.getElementById('dailyChart').getContext('2d');
            new Chart(dailyCtx, {
                type: 'line',
                data: {
                    labels: ['ì›”', 'í™”', 'ìˆ˜', 'ëª©', 'ê¸ˆ', 'í† ', 'ì¼'],
                    datasets: [{
                        label: 'ì‚¬ìš©ì ìˆ˜',
                        data: [280, 310, 295, 340, 328, 290, 320],
                        borderColor: '#5E6B3A',
                        backgroundColor: 'rgba(94, 107, 58, 0.1)',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        y: { beginAtZero: true }
                    }
                }
            });
            
            // ì¸ê¸° ì£¼ì œ ì°¨íŠ¸
            const topicsCtx = document.getElementById('topicsChart').getContext('2d');
            new Chart(topicsCtx, {
                type: 'doughnut',
                data: {
                    labels: ['ëª¨ìœ ìˆ˜ìœ ', 'ìˆ˜ë©´', 'ì´ìœ ì‹', 'ê±´ê°•', 'ê¸°íƒ€'],
                    datasets: [{
                        data: [35, 25, 20, 12, 8],
                        backgroundColor: [
                            '#5E6B3A',
                            '#8A9A5B',
                            '#E8B4B8',
                            '#F5D6D9',
                            '#E0E0E0'
                        ]
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: { padding: 16 }
                        }
                    }
                }
            });
        }
        
        // APIì—ì„œ ë°ì´í„° ë¡œë“œ (ì‹¤ì œ ì—°ë™ ì‹œ ì‚¬ìš©)
        async function loadDashboardData() {
            try {
                // ì˜ˆì‹œ: const response = await fetch('/api/admin?action=overview');
                // const data = await response.json();
                // document.getElementById('totalUsers').textContent = data.totalUsers.toLocaleString();
                console.log('Dashboard data loaded');
            } catch (error) {
                console.error('Failed to load dashboard data:', error);
            }
        }
        
        // ì´ˆê¸°í™”
        checkAuth();
        initCharts();
        loadDashboardData();
    </script>
</body>
</html>
